angular.module("ww",["ngMaterial"]);var charts;!function(t){"use strict";var e=function(){function t(){}return t.prototype.set=function(t,e){"string"==typeof t&&(this.toStr=e,this.fromStr=t),"number"==typeof t&&(this.toStr=new Date(e).toISOString(),this.fromStr=new Date(t).toISOString()),"object"==typeof t&&(this.toStr=e.toISOString(),this.fromStr=t.toISOString())},Object.defineProperty(t.prototype,"from",{get:function(){return new Date(this.fromStr)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return new Date(this.toStr)},enumerable:!0,configurable:!0}),t}();t.Dates=e}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict";var e;!function(t){t[t.Vertical=0]="Vertical",t[t.Horizontal=1]="Horizontal",t[t.Both=2]="Both"}(e=t.Orientation||(t.Orientation={}));var i;!function(t){t[t.String=0]="String",t[t.DateTime=1]="DateTime",t[t.OrdinalTime=2]="OrdinalTime",t[t.Value=3]="Value"}(i=t.AxisDataTypes||(t.AxisDataTypes={}));var n=function(){function t(){this.name="",this.title="",this.dataType=i.Value,this.dates=null,this.orientation=e.Horizontal,this.hideLine=!1,this.ticks=-1,this.basedOn="",this.useDataAlone=!0,this.includeFields=["EngUnitMin","EngUnitMax"],this.includeValues=[],this.visible=!0,this.range=null,this.index=[],this.bands=!1,this.groupBy="",this.timeAggregate=null,this.type="SINGLE",this.labelsAngles=0,this.ticksLength=10,this.justScale=!1,this.minMax=null,this.dateTimeMultiline=!1,this.enableInteractiveArea=!0}return t}();t.AxisOption=n}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function e(){this.style={},this.visible=!1,this.mode=t.Orientation.Both,this.horizontalAxis="x0",this.verticalAxis="y0"}return e}();t.GridOption=e}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function t(t,e,i){void 0===t&&(t=!0),void 0===e&&(e="bottom"),void 0===i&&(i=!1),this.visible=t,this.placement=e,this.showUnits=i}return t}();t.LegendOption=e}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function t(){this.xaxisScale="",this.yaxisScale="",this.text="",this.visible=!1,this.position=0}return t}();t.LimitLineOption=e}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function t(){this.style={},this.highlightLastPoint=!1,this.fillArea=!1,this.visible=!0,this.index=-1,this.xaxisScale="x",this.yaxisScale="y"}return t}();t.LinesOption=e}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function t(){this.cx="",this.cy="",this.r=4,this.style={},this.xaxisScale="x",this.yaxisScale="y"}return t}();t.CirclesOption=e}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function t(t,e,i,n){void 0===t&&(t=10),void 0===e&&(e=10),void 0===i&&(i=10),void 0===n&&(n=10),this.top=t,this.left=e,this.bottom=i,this.right=n}return t.prototype.set=function(t,e,i,n){this.top=t,this.left=e,this.right=n,this.bottom=i},t}();t.MarginOption=e}(charts||(charts={}));var charts;!function(t){"use strict";var e;!function(t){t[t.Combined=0]="Combined",t[t.Solo=1]="Solo"}(e=t.ScooterBehaviours||(t.ScooterBehaviours={}));var i=function(){function t(){this.visible=!0,this.xaxisScale="x",this.yaxisScale="y",this.behaviour=e.Combined}return t}();t.ScooterOption=i}(charts||(charts={}));var charts;!function(t){"use strict";var e;!function(t){t[t.Default=0]="Default",t[t.None=1]="None"}(e=t.AnimationTypes||(t.AnimationTypes={}));var i=function(){function i(){this.circles=null,this.linesWithDots=null,this.gesture=null,this.toolbar=null,this.allowedTimeRange=[],this.d3PanAndZoom=null,this.animationType=e.Default,this.dateTimeFormat="",this.disablePanAndZoomControlsArea=!1,this.title="",this.margin=new t.MarginOption,this.legend=new t.LegendOption,this.axes=[],this.limitLines=[],this.grid=new t.GridOption,this.scooter=new t.ScooterOption,this.lines=new t.LinesOption,this.hBars=new t.HorizontalBarsOptions,this.vBars=new t.VerticalBarsOptions,this.d3PanAndZoom=new t.D3PanAndZoomOption}return i}();t.Options=i}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function t(){this.enable=!1,this.events={}}return t}();t.Pan=e;var i=function(){function t(){this.enable=!1,this.events={}}return t}();t.Zoom=i;var n=function(){function t(){this.horizontalPan=null,this.verticalPan=null,this.pinchZoom=null,this.panZoomArea={w:0,h:0},this.horizontalPan=new e,this.verticalPan=new e,this.pinchZoom=new i}return t}();t.GestureOption=n}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function t(){this.id=0,this.toolTip="",this.image="",this.color="",this.events={}}return t}();t.ToolbarButtonOption=e;var i=function(){function t(){this.visible=!1,this.height=30,this.style={},this.buttons=[]}return t}();t.ToolbarOption=i}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function t(){this.minimum=0,this.maximum=0,this.text="minimum",this.xaxisScale="x",this.yaxisScale="y"}return t}();t.HorizontalBarsOptions=e}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function t(){this.xaxisScale="",this.yaxisScale="",this.groupBy="",this.visible=!1}return t}();t.LinesWithDots=e}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function t(){this.xaxisScale="",this.yaxisScale="",this.groupBy="",this.drillIn="",this.visible=!1,this.basedOn="",this.hideSubgroupLines=!1,this.tooltip=!1}return t}();t.VerticalBarsOptions=e}(charts||(charts={}));var charts;!function(t){"use strict";!function(t){t[t.Zoom=0]="Zoom",t[t.Pan=1]="Pan"}(t.ChartInteractions||(t.ChartInteractions={}));var e=function(){function t(){this.enable=!1,this.onStartHandler=null,this.onEndHandler=null}return t}();t.D3Pan=e;var i=function(){function t(){this.enable=!1,this.onStartHandler=null,this.onEndHandler=null}return t}();t.D3Zoom=i;var n=function(){function t(){this.pan=null,this.zoom=null,this.xAxisScale="",this.yAxisScale="",this.pan=new e,this.zoom=new i}return t}();t.D3PanAndZoomOption=n}(charts||(charts={}));var ww;!function(t){!function(t){"use strict";function e(){return null!=navigator.userAgent.match(/iPad/i)||null!=navigator.userAgent.match(/Android/i)}function i(t){return new Date(t).getTime()}function n(t){var e=encodeURIComponent(t);return(t.indexOf("\\")>-1||t.indexOf("/")>-1)&&(e=encodeURIComponent(encodeURIComponent(t))),e}function s(t,e){if(void 0===e)return e;var i=e.split("."),n=t;return i.forEach(function(t){void 0!==n&&(n=n[t])}),n}function a(t,e){var i=0;t===e&&(t-=1,e+=1),i=Math.pow(10,Math.round(Math.log(Math.abs(e-t))-.95));var n=Math.floor(e/i)*i+i;return[Math.ceil(t/i)*i-i,n]}function r(t){return"string"==typeof t?t.indexOf(".")>-1?parseFloat(t):parseInt(t):"number"==typeof t?t:0}function o(t,e,i){if(void 0===t)return-1;var n=0,s=t.length;for(n=0;n<s;n+=1)if(t[n][i]===e)return n;return-1}function c(t,e,i){var n=0,s=t.length;for(n=0;n<s;n+=1){var a=t[n];if(a[i]===e)return a}return null}function h(t){return t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function l(t,e,i){return i.replace(new RegExp(h(t),"g"),e)}var u=function(){function t(){this.startAt=0,this.stoppedAt=0,this.elapsedDuration=0}return t.prototype.now=function(){return(new Date).getTime()},t.prototype.start=function(t){void 0===t&&(t=""),this.startAt=this.now(),t.length},t.prototype.stop=function(){this.stoppedAt=this.now()},t.prototype.pause=function(){this.stoppedAt=this.now(),this.elapsedDuration=this.elapsedDuration+(this.startAt?this.stoppedAt-this.startAt:0),this.stoppedAt=0},t.prototype.continue=function(){this.start()},t.prototype.reset=function(){this.startAt=0,this.stoppedAt=0,this.elapsedDuration=0},t.prototype.logElapsedDuration=function(t,e){void 0===e&&(e=!1),this.pause(),this.continue(),e&&this.reset()},t}();t.StopWatch=u,t.checkForTouchDevice=e,t.parseDate=i,t.customTimeFormat=d3.time.format.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return 1!==t.getDate()}],["%b %d",function(t){return t.getMonth()}],["%Y",function(){return!0}]]),t.encodeTag=n,t.getPropertyVal=s,t.computeNiceRanges=a,t.parseStringToNumber=r,t.arrayObjectIndexOf=o,t.objectInArray=c,t.escapeRegExp=h,t.replaceAll=l,String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)}}(t.Utilities||(t.Utilities={}))}(ww||(ww={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){"use strict"}(charts||(charts={}));var charts;!function(t){var e=function(){function t(){this.panAndZoom=null}return t}();t.Abilities=e}(charts||(charts={}));var charts;!function(t){var e=function(){function e(e){this.chart=e,this.stopWatch=new ww.Utilities.StopWatch,this.xScale=null,this.yScale=null,this.isInitialized=!1,this.controlsArea=null,this.panCapability=null,this.zoomCapability=null,this.xScale=e.scales[this.chart.options.d3PanAndZoom.xAxisScale+0],this.yScale=e.scales[this.chart.options.d3PanAndZoom.yAxisScale+0],this.controlsArea=new t.PanAndZoomControlsArea,this.panCapability=new t.PanCapability(this),this.zoomCapability=new t.ZoomCapability(this)}return e.prototype.update=function(){var t=this;if(this.stopWatch.start(),this.chart.options.d3PanAndZoom.pan.enable&&this.chart.options.d3PanAndZoom.zoom.enable){var e=this.chart.svg.select(".interactive-group").attr("transform","translate("+this.chart.margin.left+", "+this.chart.margin.top+")"),i=e.select(".interactiveArea");i.empty()&&(i=e.append("rect").attr({class:"interactiveArea",x:0,y:0,"fill-opacity":"0"}),i.style("pointer-events","All")),i.attr({width:this.chart.width,height:this.chart.height}),setTimeout(function(){var e=t.chart.element.select(".chart-controls-area");e.empty()||(e.style("display",ww.Utilities.checkForTouchDevice()?"none":""),t.isInitialized?(t.panCapability.Update(t.chart,t.xScale,t.yScale),t.zoomCapability.Update(t.chart,t.xScale,t.yScale)):(t.controlsArea.AttachTo(t.chart),t.panCapability.AttachTo(t.chart,t.xScale,t.yScale),t.zoomCapability.AttachTo(t.chart,t.xScale,t.yScale),t.isInitialized=!0))},1)}else{var n=this.chart.element.select(".chart-controls-area");n.empty()||n.style("display","none"),this.isInitialized&&(this.zoomCapability.DetachFrom(this.chart),this.panCapability.DetachFrom(this.chart),this.controlsArea.DetachFrom(this.chart),this.isInitialized=!1)}this.stopWatch.logElapsedDuration("lines update took: "),this.stopWatch.reset()},e}();t.PanAndZoom=e}(charts||(charts={}));var charts;!function(t){var e=function(){function e(){}return e.prototype.AttachTo=function(e){var i=e.element.select(".chart-controls-area");if(!0===e.options.disablePanAndZoomControlsArea)return void i.style("display","none");i.on("mouseover",function(){i.style("opacity","0.8"),i.style("transition","opacity 0.4s"),e.scooter&&e.scooter.options.behaviour!==t.ScooterBehaviours.Solo&&e.scooter.hide()}).on("mouseleave",function(){i.style("opacity","0"),i.style("transition","opacity 0.4s"),e.scooter&&e.scooter.options.behaviour!==t.ScooterBehaviours.Solo&&e.scooter.hide()})},e.prototype.DetachFrom=function(t){t.element.select(".chart-controls-area").on("mouseover",null).on("mouseleave",null)},e}();t.PanAndZoomControlsArea=e}(charts||(charts={}));var charts;!function(t){var e=function(){function e(){this.stopWatch=new ww.Utilities.StopWatch}return e.AttachCapabilityTo=function(e){var i=new t.PanAndZoom(e);e.abilities.panAndZoom=i,i.update()},e}();t.PanAndZoomFactory=e;var i=function(){function t(){this.templateUrl="./partials/panAndZoom.html",this.restrict="EA",this.link={pre:this.pre}}return t.instance=function(){return new t},t.prototype.pre=function(t,i,n){var s=t.canvas;e.AttachCapabilityTo(s)},t}();i.$inject=[""],angular.module("ww").directive("wwPanAndZoom",i.instance)}(charts||(charts={}));var charts;!function(t){var e;!function(t){t[t.Left=1]="Left",t[t.Right=2]="Right"}(e=t.PanDirection||(t.PanDirection={}));var i=function(){function t(t){this.parent=t,this.zoom=null,this.chart=null,this.xScale=null,this.yScale=null,this.retrieveDataTimer=null}return t.prototype.AttachTo=function(t,e,i){var n=this;this.xScale=e,this.yScale=i,this.chart=t,this.chart.element.select(".pan-left").on("click",function(){n.panLeft()}),this.chart.element.select(".pan-right").on("click",function(){n.panRight()}),this.chart.element.select(".expand-left").on("click",function(){n.expandLeft()}),this.chart.element.select(".expand-right").on("click",function(){n.expandRight()})},t.prototype.Update=function(t,e,i){this.xScale=e,this.yScale=i,this.chart=t},t.prototype.DetachFrom=function(t){t.element.select(".pan-left").on("click",null),t.element.select(".pan-right").on("click",null),t.element.select(".expand-left").on("click",null),t.element.select(".expand-right").on("click",null)},t.prototype.expandRight=function(){var t=this.xScale.func.domain(),i=[new Date(t[0]).getTime(),new Date(t[1]).getTime()],n=i[1]-i[0]+1e3,s=i[1]+n/2,a=[i[0],s];this.performPanOperation(e.Right,t,a)},t.prototype.panLeft=function(){var t=this.xScale.func.domain(),i=[new Date(t[0]).getTime(),new Date(t[1]).getTime()],n=i[1]-i[0]+1e3,s=i[1]-n/2,a=[s-n+1e3,s];this.performPanOperation(e.Left,t,a)},t.prototype.panRight=function(){var t=this.xScale.func.domain(),i=[new Date(t[0]).getTime(),new Date(t[1]).getTime()],n=i[1]-i[0],s=i[1]+n/2+1e3,a=[s-n,s];this.performPanOperation(e.Right,t,a)},t.prototype.panChart=function(t){var e=this;if(t){var i=this.xScale.func.domain()[0],n=this.xScale.func.domain()[1];this.chart.g.transition().duration(750).each("start",function(){e.chart.children.forEach(function(t){"zoom"in t?t.zoom():"children"in t&&t.children.forEach(function(t){"zoom"in t&&t.zoom(i,n)})})}),null!==this.retrieveDataTimer&&clearTimeout(this.retrieveDataTimer),this.retrieveDataTimer=setTimeout(function(){e.chart.options.d3PanAndZoom.pan.onEndHandler(new Date(i).getTime(),new Date(n).getTime()),e.retrieveDataTimer=null},1e3)}},t.prototype.expandLeft=function(){var t=this.xScale.func.domain(),i=[new Date(t[0]).getTime(),new Date(t[1]).getTime()],n=i[1]-i[0],s=i[0]-n/2+1e3,a=[s-1e3,t[1]];this.performPanOperation(e.Left,t,a)},t.prototype.performPanOperation=function(t,i,n){var s=[new Date(i[0]).getTime(),new Date(i[1]).getTime()],a=[new Date(n[0]),new Date(n[1])];this.xScale.func.domain(a);var r=t===e.Left?this.canPanLeft(s):this.canPanRight(s);this.panChart(!1);var o=this.getValidTimeRange(n);r?(this.setXScaleDomain(o),this.panChart(r)):this.showRubberbandBehaviour(i)},t.prototype.getValidTimeRange=function(t){var e=t,i=t[0],n=t[1];return this.chart.options.allowedTimeRange&&(i=new Date(this.chart.options.allowedTimeRange[0]),n=new Date(this.chart.options.allowedTimeRange[1])),e[0]=t[0]<i.getTime()?i:t[0],e[1]=t[1]>n.getTime()?n:t[1],e},t.prototype.canPanRight=function(t){return new Date(this.chart.options.allowedTimeRange[1]).getTime()!==t[1]},t.prototype.canPanLeft=function(t){return new Date(this.chart.options.allowedTimeRange[0]).getTime()!==t[0]},t.prototype.showRubberbandBehaviour=function(t){var e=this;setTimeout(function(){e.setXScaleDomain(t),e.panChart(!1)},100)},t.prototype.setXScaleDomain=function(t){this.xScale.func.domain(t),this.parent.zoomCapability.updateDomain()},t}();t.PanCapability=i}(charts||(charts={}));var charts;!function(t){var e=function(){function e(e){this.parent=e,this.zoom=null,this.brush=null,this.chart=null,this.xScale=null,this.yScale=null,this.retrieveDataTimer=null,this.showRubberBandEffectForZoomOperation=!1,this.showRubberBandEffectForPanOperation=!1,this.panDirection=t.PanDirection.Right,this.isDisplayRangeMaxAtRightEdge=!1,this.isDisplayRangeMaxAtLeftEdge=!1,this.keydownHandler=null,this.zoomActivated=!1,this.startTimeBeforeZoom=null,this.endTimeBeforeZoom=null,this.eventType=null}return e.prototype.AttachTo=function(t,e,i){this.xScale=e,this.yScale=i,this.chart=t,this.chart.addElement(this),this.enableZooming(),this.enableBrush()},e.prototype.updateDomain=function(){this.zoom.x(this.xScale.func),this.zoom.scale(1),this.brush.x(this.xScale.func)},e.prototype.Update=function(t,e,i){this.xScale=e,this.yScale=i,this.chart=t;var n=this.xScale.func,s=n.domain(),a=this.zoom.x().domain();s[0]===a[0]&&s[1]===a[1]||(this.zoom.x(this.xScale.func),this.zoom.scale(1),this.brush.x(this.xScale.func))},e.prototype.update=function(){var t=this;this.zoom&&(!0===this.chart.options.gesture.horizontalPan.enable&&!1===this.zoomActivated?(this.chart.svg.select(".interactive-group").select(".interactiveArea").call(this.zoom),this.chart.element.select(".zoom-in").on("click",function(){t.zoomIn()}),this.chart.element.select(".zoom-out").on("click",function(){t.zoomOut()}),this.zoomActivated=!0):!1===this.chart.options.gesture.horizontalPan.enable&&!0===this.zoomActivated&&(this.chart.svg.select(".interactive-group").select(".interactiveArea").call(this.zoom).on("mousedown.zoom",null).on("touchstart.zoom",null).on("touchmove.zoom",null).on("touchend.zoom",null),this.zoomActivated=!1))},e.prototype.DetachFrom=function(t){this.disableZooming(),this.disableBrush()},e.prototype.enableZooming=function(){var t=this;if(!this.xScale){return;}this.zoom=d3.behavior.zoom().x(this.xScale.func).on("zoom",function(){t.zoomed()}).on("zoomstart",function(){t.zoomStarted()}).on("zoomend",function(){t.zoomEnd()})},e.prototype.disableZooming=function(){this.chart.svg.select(".interactive-group").select(".interactiveArea").on(".zoom",null),this.zoom.on("zoom",null),this.chart.element.select(".zoom-in").on("click",null),this.chart.element.select(".zoom-out").on("click",null)},e.prototype.zoomStarted=function(){var t=d3.event;"buttons"in t.sourceEvent?1===t.sourceEvent.buttons&&this.chart.options.d3PanAndZoom.pan.onStartHandler?this.chart.options.d3PanAndZoom.pan.onStartHandler():t.buttons>1&&this.chart.options.d3PanAndZoom.zoom.onStartHandler&&this.chart.options.d3PanAndZoom.zoom.onStartHandler():"touches"in t.sourceEvent&&(1===t.sourceEvent.touches.length&&this.chart.options.d3PanAndZoom.pan.onStartHandler?this.chart.options.d3PanAndZoom.pan.onStartHandler():t.sourceEvent.touches.length>1&&this.chart.options.d3PanAndZoom.zoom.onStartHandler&&this.chart.options.d3PanAndZoom.zoom.onStartHandler()),this.showRubberBandEffectForZoomOperation||(this.startTimeBeforeZoom=this.xScale.func.domain()[0],this.endTimeBeforeZoom=this.xScale.func.domain()[1],this.isDisplayRangeMaxAtRightEdge=this.endTimeBeforeZoom===new Date(this.chart.options.allowedTimeRange[1]).getTime(),this.isDisplayRangeMaxAtLeftEdge=this.startTimeBeforeZoom===new Date(this.chart.options.allowedTimeRange[0]).getTime())},e.prototype.zoomEnd=function(){var e=this,i=new Date(this.xScale.func.domain()[0]),n=new Date(this.xScale.func.domain()[1]);if(null!==this.chart.options.allowedTimeRange){var s=this.getValidTimeRange([i,n]);this.showRubberBandEffectForPanOperation&&(this.panDirection===t.PanDirection.Left&&this.isDisplayRangeMaxAtLeftEdge?s[1]=this.endTimeBeforeZoom:this.panDirection===t.PanDirection.Right&&this.isDisplayRangeMaxAtRightEdge&&(s[0]=this.startTimeBeforeZoom)),setTimeout(function(){e.xScale.func.domain(s),e.zoom.x(e.xScale.func),e.brush.x(e.xScale.func),e.zoomChart(),e.showRubberBandEffectForPanOperation=!1,e.showRubberBandEffectForZoomOperation=!1,e.isDisplayRangeMaxAtRightEdge=!1,e.isDisplayRangeMaxAtLeftEdge=!1},100)}},e.prototype.zoomChart=function(){var e=this,i=this.xScale.func.domain()[0],n=this.xScale.func.domain()[1];if(this.chart.options.scooter.behaviour!==t.ScooterBehaviours.Solo||!0!==this.chart.options.scooter.visible){switch(this.chart.options.animationType){case t.AnimationTypes.None:this.chart.axes[this.xScale.name].update(),this.chart.children.forEach(function(t){"zoom"in t&&t!==e?t.zoom():"children"in t&&t.children.forEach(function(t){"zoom"in t&&t!==e&&t.zoom(i,n)})});break;default:this.chart.g.transition().duration(750).each("start",function(){e.chart.children.forEach(function(t){"zoom"in t?t.zoom():"children"in t&&t.children.forEach(function(t){"zoom"in t&&t.zoom(i,n)})})})}this.showRubberBandEffectForZoomOperation||this.showRubberBandEffectForPanOperation||(null!==this.retrieveDataTimer&&clearTimeout(this.retrieveDataTimer),this.retrieveDataTimer=setTimeout(function(){"pan"===e.eventType&&e.chart.options.d3PanAndZoom.pan.onEndHandler?e.chart.options.d3PanAndZoom.pan.onEndHandler(new Date(e.xScale.func.domain()[0]).getTime(),new Date(e.xScale.func.domain()[1]).getTime()):"zoom"===e.eventType&&e.chart.options.d3PanAndZoom.zoom.onEndHandler&&e.chart.options.d3PanAndZoom.zoom.onEndHandler(new Date(e.xScale.func.domain()[0]).getTime(),new Date(e.xScale.func.domain()[1]).getTime()),e.retrieveDataTimer=null},1e3))}},e.prototype.zoomed=function(){1===this.zoom.scale()?(this.panDirection=this.zoom.translate()[0]<0?t.PanDirection.Right:t.PanDirection.Left,this.showRubberBandEffectForPanOperation=this.panDirection===t.PanDirection.Left&&this.isDisplayRangeMaxAtLeftEdge||this.panDirection===t.PanDirection.Right&&this.isDisplayRangeMaxAtRightEdge):new Date(this.startTimeBeforeZoom).getTime()===new Date(this.chart.options.allowedTimeRange[0]).getTime()&&new Date(this.endTimeBeforeZoom).getTime()===new Date(this.chart.options.allowedTimeRange[1]).getTime()&&(this.showRubberBandEffectForZoomOperation=this.zoom.scale()<1);var e=d3.event,i=e.translate,n=(i[0],i[1],e.scale,d3.event);"buttons"in n.sourceEvent?1===n.sourceEvent.buttons?this.eventType="pan":n.buttons>1&&(this.eventType="zoom"):"touches"in n.sourceEvent&&(1===n.sourceEvent.touches.length?this.eventType="pan":n.sourceEvent.touches.length>1&&(this.eventType="zoom")),this.zoomChart()},e.prototype.d3_behavior_zoomDelta=function(t){return"in"===t?100:-100},e.prototype.zoomClick=function(t){var e=1,i=[this.chart.width/2,this.chart.height/2],n=(this.zoom.scaleExtent(),this.zoom.translate()),s=[],a=[],r={x:n[0],y:n[1],k:this.zoom.scale()};return d3.event.preventDefault(),e=t,s=[(i[0]-r.x)/r.k,(i[1]-r.y)/r.k],r.k=e,a=[s[0]*r.k+r.x,s[1]*r.k+r.y],r.x+=i[0]-a[0],r.y+=i[1]-a[1],r},e.prototype.performManualZoom=function(t){var e=(this.chart.height,this.chart.width,Math.pow(2,.002*this.d3_behavior_zoomDelta(t))*this.zoom.scale()),i=this.zoomClick(e);this.zoom.scale(i.k).translate([i.x,i.y]),this.zoom.event(this.chart.svg.select(".interactive-group").select(".interactiveArea"))},e.prototype.zoomIn=function(){this.performManualZoom("in")},e.prototype.zoomOut=function(){var t=new Date(this.xScale.func.domain()[0]),e=new Date(this.xScale.func.domain()[1]);t.getTime()===new Date(this.chart.options.allowedTimeRange[0]).getTime()&&e.getTime()===new Date(this.chart.options.allowedTimeRange[1]).getTime()&&(this.showRubberBandEffectForZoomOperation=!0),this.eventType="zoom",this.performManualZoom("out")},e.prototype.brushed=function(){var t=[new Date(this.brush.extent()[0]),new Date(this.brush.extent()[1])];t[0].getTime()!==t[1].getTime()&&(this.xScale.func.domain(t),this.chart.svg.select(".interactive-group").select(".brush").call(this.brush.clear()),this.chart.svg.select(".interactive-group").select(".brush").remove(),this.zoom.x(this.xScale.func),this.brush.x(this.xScale.func),this.eventType="zoom",this.zoomChart())},e.prototype.enableBrush=function(){var t=this;if(!this.xScale){return;}this.brush=d3.svg.brush().x(this.xScale.func).on("brushstart",function(){t.chart.options.d3PanAndZoom.zoom.onStartHandler&&t.chart.options.d3PanAndZoom.zoom.onStartHandler()}).on("brushend",function(){t.brushed(),$(document).unbind("keydown",t.keydownHandler)}),this.keydownHandler=function(e){var i=t.chart.svg.select(".interactive-group");27!==e.keyCode||i.select(".brush").empty()||(i.select(".brush").call(t.brush.clear()),i.select(".brush").remove())},this.chart.element.select(".zoom").on("click",function(){var e=t.chart.svg.select(".interactive-group");e.select(".brush").empty()&&(e.append("g").attr("class","x brush").style({fill:"lightgray",opacity:.5,stroke:"black"}),e.select(".brush").call(t.brush).selectAll("rect").attr("y",0).attr("height",t.chart.height),$(document).keydown(t.keydownHandler))})},e.prototype.disableBrush=function(){this.brush=d3.svg.brush().x(this.xScale.func).on("brushend",null),this.chart.element.select(".zoom").on("click",null)},e.prototype.getValidTimeRange=function(t){var e=t,i=t[0],n=t[1];return this.chart.options.allowedTimeRange&&(i=new Date(this.chart.options.allowedTimeRange[0]),n=new Date(this.chart.options.allowedTimeRange[1])),e[0]=t[0].getTime()<=i.getTime()?i:t[0],e[1]=t[1].getTime()>=n.getTime()?n:t[1],e},e}();t.ZoomCapability=e}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function t(t){this.chart=t}return t.prototype.getFlexInfo=function(t,e){var i=100;return e<=500?i=50:e>500&&e<=600?i=t>3?33:Math.ceil(100/t):e>600&&e<=960?i=t>4?25:Math.ceil(100/t):e>960&&e<=1400?i=t>5?20:Math.ceil(100/t):e>1400&&(i=t>6?15:Math.ceil(100/t)),"flex-"+i},t.prototype.calculateHeight=function(){var t=0,e=this.chart.element.select(".legend");return e.empty()||(t=parseFloat(e.style("height")),t=isNaN(t)?0:t),t},t.prototype.hide=function(){var t=this.chart.element.select(".legend");t.empty()||(t.selectAll("*").remove(),this.chart.margin.bottom=this.chart.options.margin.bottom+this.calculateHeight())},t.prototype.show=function(){var t=null,e=this.chart.element.select(".legend");e.empty()&&(e=this.chart.element.append("div").attr({id:"legendTable",css:"legendTable",class:"legend ww-chart-no-selectable",layout:"column"})),e.style({"margin-left":this.chart.margin.left+"px","margin-right":this.chart.margin.right+"px",width:this.chart.width+"px",bottom:0,position:"absolute"}),t=e.select(".legend-items"),t.empty()&&(t=e.append("div").attr("class","legend-items layout-wrap layout-row"));var i=[],n=this;this.chart.data.forEach(function(t){if(void 0!==t.Color&&"#EEEEEE"!==t.Color){var e="";""!==t.FQN&&-1===ww.Utilities.arrayObjectIndexOf(i,t.FQN,"FQN")&&(n.chart.options.legend.showUnits&&(e=t.EngUnit?" ("+t.EngUnit+")":""),i.unshift({FQN:t.FQN,name:t.FQN.substring(t.FQN.indexOf(".")+1,t.FQN.length),color:t.Color,engUnit:e}))}});var s=this.getFlexInfo(i.length,this.chart.width),a=t.selectAll(".legend-item").data(i);a.enter().append("div").attr("class","legend-item "+s).append("div").attr("class","legend-text"),a.exit().remove(),a.attr("class","legend-item "+s).style({"border-left":function(t){return"6px solid "+t.color}}).select(".legend-text").text(function(t){return t.name+t.engUnit}),this.chart.margin.bottom=this.chart.options.margin.bottom+this.calculateHeight()},t}();t.Legend=e}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function e(e){this.stopWatch=new ww.Utilities.StopWatch,this.isUpdateOpComplete=!1,this.clipPathId="chart"+(new Date).getTime(),this.options=null,this.data=[],this.scales={},this.axes=[],this.children=[],this.width=0,this.height=0,this.gesture=null,this.legend=new t.Legend(this),this.scooter=null,this.abilities=null,this.chart=null,this.html='<svg style="position:absolute;top:0;left:0;" width="100%" height="100%">\n    <text class="chart-title"></text>\n    <g id="chartElementGroup" transform="translate(0, 0)"></g>\n    <g class="interactive-group" transform="translate(0, 0)"></g>\n</svg>',this.abilities=new t.Abilities,this.chart=e,this.element=d3.select(this.chart.element),this.containerElement=d3.select(this.chart.chartContainer),this.reInitialize(this.chart),this.margin=JSON.parse(JSON.stringify(this.options.margin)),this.svg=this.element.select("svg"),this.g=this.svg.select("g"),this.svg.select("defs").select("clipPath").attr("id",this.clipPathId),this.update(!1)}return e.prototype.reInitialize=function(t){this.options=t.options,this.data=t.data},e.prototype.getParent=function(t){if("charts"in t.$parent)return t.$parent;this.getParent(t.$parent)},e.prototype.calculateWidth=function(){if(this.svg&&this.containerElement){var t=parseFloat(this.svg.style("width")),e=parseFloat(this.containerElement.style("width"));this.width=(0===t?e:t)-this.margin.left-this.margin.right,this.width=this.width>=0?this.width:0}else this.width=0},e.prototype.calculateHeight=function(){if(this.svg&&this.containerElement){var t=parseFloat(this.svg.style("height")),e=parseFloat(this.containerElement.style("height"));this.height=(0===t?e:t)-this.margin.top-this.margin.bottom,this.height=this.height>=0?this.height:0}else this.height=0},e.prototype.transformChartPosition=function(){this.g.attr("transform","translate("+this.margin.left+", "+this.margin.top+")"),this.svg.select(".interactive-group").attr("transform","translate("+this.margin.left+", "+this.margin.top+")"),this.svg.select("#"+this.clipPathId+" rect").attr({width:this.width,height:this.height})},e.prototype.setChartTitle=function(t){if(t.length>0){var e=parseFloat(this.svg.style("width"));this.svg.select(".chart-title").attr({x:e/2,y:-8}).text(t)}},e.prototype.addClippingRegion=function(){this.g.select("defs").empty()&&this.g.append("defs").append("svg:clipPath").attr("id",this.clipPathId).append("svg:rect").attr("x",0).attr("y",0).attr("width","100").attr("height","100")},e.prototype.update=function(t){this.stopWatch.start(),this.isUpdateOpComplete=!1,this.reInitialize(this.chart),this.addClippingRegion(),this.calculateWidth(),this.options.legend.visible?this.legend.show():this.legend.hide(),this.calculateHeight(),this.transformChartPosition(),this.setChartTitle(this.options.title),this.stopWatch.logElapsedDuration("base chart update took: ",!0),this.stopWatch.start(),t&&(this.children.forEach(function(t){t.update()}),this.children=this.children.filter(function(t){return!t.isObsolete})),this.stopWatch.logElapsedDuration("redrawing children update took: ",!0),this.isUpdateOpComplete=!0},e.prototype.addElement=function(t){this.children.push(t)},e.prototype.removeElement=function(t){var e=-1;this.children.some(function(i,n){if(i===t)return e=n,!0}),e>-1&&delete this.children[e]},e}();t.Canvas=e;var i=function(){function t(){this.templateUrl="./partials/chart.html",this.restrict="E",this.transclude=!0,this.link={pre:this.pre}}return t.instance=function(){return new t},t.prototype.pre=function(t,i,n){var s=t.chart,a=new e(s);t.canvas=a,t.chart.canvases.push(a)},t}();i.$inject=[""],angular.module("ww").directive("wwCanvas",i.instance)
}(charts||(charts={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),charts;!function(t){"use strict";var e=function(){function t(t,e){this.from=t,this.to=e}return t}(),i=function(){function t(t,e){this.min=t,this.max=e}return t}(),n=function(){function t(){this.tag=null}return t.prototype.update=function(){},t.prototype.remove=function(){},t.prototype.setZoom=function(t,e){},t.prototype.setMinMax=function(t,e){},t.prototype.baseType=function(){return"Scale"},t.prototype.type=function(){return"Scale"},t}(),s=function(e){function n(t,i,n){var s=e.call(this)||this;return s.chart=t,s.options=i,s.scaleIndex=n,s.zoomDates=null,s.stopWatch=new ww.Utilities.StopWatch,s.minMaxValues=null,s.func=null,s.isObsolete=!1,s.values=[],s.unit="",s.func=d3.time.scale(),s.name=n>-1?i.name+s.scaleIndex:i.name,s}return __extends(n,e),n.prototype.getTimeExtent=function(t,e){var i=[t.getTime(),e.getTime()];return d3.extent(i)},n.prototype.baseType=function(){return e.prototype.baseType.call(this)},n.prototype.type=function(){return"TimeScale"},n.prototype.setZoom=function(e,i){this.zoomDates=new t.Dates,this.zoomDates.set(e,i)},n.prototype.setMinMax=function(t,e){this.minMaxValues=new i(t,e),null===this.options.minMax&&(this.options.minMax=[]),this.options.minMax.length=0,this.options.minMax.push(t),this.options.minMax.push(e)},n.prototype.update=function(){this.stopWatch.start(),this.options=ww.Utilities.objectInArray(this.chart.options.axes,this.options.name,"name");var e=[],n=this.options.orientation||t.Orientation.Horizontal;switch("SINGLE"!==this.options.type?this.chart.data.length>0?this.unit=this.chart.data[0][this.options.title]:this.unit="":this.unit=this.options.title,this.options.minMax?(this.minMaxValues=new i(this.options.minMax[0],this.options.minMax[1]),this.minMaxValues&&this.minMaxValues.max!=this.minMaxValues.min&&(e=this.getTimeExtent(new Date(this.minMaxValues.min),new Date(this.minMaxValues.max)))):e=null!=this.zoomDates&&!0===this.chart.options.gesture.horizontalPan.enable?this.getTimeExtent(this.zoomDates.from,this.zoomDates.to):this.getTimeExtent(this.options.dates.from,this.options.dates.to),n){case t.Orientation.Horizontal:this.func.range([0,this.chart.width]).domain(e);break;case t.Orientation.Vertical:this.func.range([this.chart.height,0]).domain(e)}this.stopWatch.logElapsedDuration("Time scale "+this.name+" update took: ",!0)},n.prototype.remove=function(){},n}(n),a=function(e){function i(t,i,n){var s=e.call(this)||this;return s.chart=t,s.options=i,s.scaleIndex=n,s.stopWatch=new ww.Utilities.StopWatch,s.func=null,s.isObsolete=!1,s.values=[],s.func=d3.scale.ordinal(),s.name=n>-1?i.name+s.scaleIndex:i.name,s}return __extends(i,e),i.prototype.getTimeExtent=function(t,e){return[t.getTime(),e.getTime()]},i.prototype.createOrdinalTimeDomain=function(t,e){return t.ticks("HOUR"===e?d3.time.hour:d3.time.day,1).map(function(t){var i=new Date(t);return"HOUR"===e&&i.setHours(i.getHours()+1),i.toISOString()})},i.prototype.curbEndTime=function(t,e){if(t){var i=t;return"DAY"===e&&0===i.getHours()?i.setDate(i.getDate()-1):"HOUR"===e&&0===i.getMinutes()&&i.setHours(i.getHours()-1),i}},i.prototype.baseType=function(){return e.prototype.baseType.call(this)},i.prototype.type=function(){return"OrdinalTimeScale"},i.prototype.setZoom=function(t,e){},i.prototype.update=function(){this.stopWatch.start(),this.options=ww.Utilities.objectInArray(this.chart.options.axes,this.options.name,"name"),"SINGLE"!==this.options.type?this.chart.data.length>0?this.unit=this.chart.data[0][this.options.title]:this.unit="":this.unit=this.options.title;var e=[],i=this.options.orientation||"horizontal",n=this.options.bands||!1,s=(this.options.dataType,this.options.basedOn,this.options.timeAggregate||null),a=(this.options.dates.from,this.options.dates.to);switch(a=this.curbEndTime(a,s),e=this.getTimeExtent(this.options.dates.from,a),i){case t.Orientation.Horizontal:n&&(this.func.auxTimeScale=d3.time.scale().range([0,this.chart.width]).domain(e),this.func.rangeBands([0,this.chart.width],.1).domain(this.createOrdinalTimeDomain(this.func.auxTimeScale,s)));break;case t.Orientation.Vertical:}this.stopWatch.logElapsedDuration("Ordinal Time scale "+this.name+" update took: ",!0)},i.prototype.remove=function(){},i}(n),r=function(e){function i(t,i,n){var s=e.call(this)||this;return s.chart=t,s.options=i,s.scaleIndex=n,s.stopWatch=new ww.Utilities.StopWatch,s.func=null,s.isObsolete=!1,s.values=[],s.func=d3.scale.ordinal(),s.name=n>-1?i.name+s.scaleIndex:i.name,s}return __extends(i,e),i.prototype.baseType=function(){return e.prototype.baseType.call(this)},i.prototype.type=function(){return"StringScale"},i.prototype.setZoom=function(t,e){},i.prototype.zoom=function(t){this.update()},i.prototype.update=function(){this.stopWatch.start(),this.options=ww.Utilities.objectInArray(this.chart.options.axes,this.options.name,"name"),"SINGLE"!==this.options.type?this.chart.data.length>0?this.unit=this.chart.data[0][this.options.title]:this.unit="":this.unit=this.options.title;var e=this.chart.data||[],i=this.options.basedOn,n=(this.options.dataType,this.options.orientation||t.Orientation.Horizontal),s=this.options.bands||!1,a=this.options.groupBy||null;n===t.Orientation.Horizontal?s?this.func.rangeRoundBands([0,this.chart.width],.1).domain(e.map(function(t){return t[i]})):null!==a?this.func.rangeRoundBands([0,this.chart.scales[a].func.rangeBand()]).domain(e.map(function(t){return t[i]})):this.func.range([0,this.chart.width]).domain(e.map(function(t){return t[i]})):n===t.Orientation.Vertical&&(s?this.func.rangeRoundBands([this.chart.height,0],.1).domain(e.map(function(t){return t[i]})):null!==a?this.func.rangeRoundBands([this.chart.scales[a].func.rangeBand(),0]).domain(e.map(function(t){return t[i]})):this.func.range([this.chart.height,0]).domain(e.map(function(t){return t[i]}))),this.stopWatch.logElapsedDuration("string scale "+this.name+" update took: ",!0)},i.prototype.remove=function(){},i}(n),o=function(n){function s(t,e,i,s){var a=n.call(this)||this;return a.chart=t,a.options=e,a.scaleIndex=i,a.tag=s,a.zoomValues=null,a.minMaxValues=null,a.stopWatch=new ww.Utilities.StopWatch,a.func=null,a.values=[],a.isObsolete=!1,a.usingMinMax=!1,a.func=d3.scale.linear().nice(),a.name=i>-1?e.name+a.scaleIndex:e.name,a}return __extends(s,n),s.prototype.adjustRange=function(t){return t[0]===t[1]&&(0===t[0]?t[0]=-.015:t[0]-=Math.abs(.015*t[0]),0===t[1]?t[1]=.015:t[1]+=Math.abs(.015*t[1])),t},s.prototype.calculateRange=function(){var t=this,e=[],i=this.options.basedOn;this.options.index;e="SINGLE"===this.options.type?this.chart.data:[this.chart.data[this.scaleIndex]];var n=[];return null!==this.options.range?n=this.options.range:e.forEach(function(e){t.options.useDataAlone||t.options.includeFields.forEach(function(t){n.push(ww.Utilities.parseStringToNumber(e[t]))}),e.values.forEach(function(t){var e=t[i];isNaN(e)||null===e||n.push(e)})}),this.options.includeValues.forEach(function(t){isNaN(t)||null===t||n.push(t)}),n},s.prototype.baseType=function(){return n.prototype.baseType.call(this)},s.prototype.type=function(){return"ValueScale"},s.prototype.zoom=function(t){this.update()},s.prototype.update=function(){if(this.options=ww.Utilities.objectInArray(this.chart.options.axes,this.options.name,"name"),"SINGLE"!==this.options.type?this.chart.data.length>0?this.unit=this.chart.data[0][this.options.title]:this.unit="":this.unit=this.options.title,this.scaleIndex>-1){if(this.scaleIndex>this.chart.data.length-1)return delete this.chart.scales[this.name],void(this.isObsolete=!0);this.updateScale()}else this.updateScale()},s.prototype.setZoom=function(t,i){this.zoomValues=new e(t,i)},s.prototype.setMinMax=function(t,e){this.minMaxValues=new i(t,e)},s.prototype.updateScale=function(){this.stopWatch.start();var e,i=this.calculateRange();switch(this.tag&&this.tag.EngUnitMax!==this.tag.EngUnitMin?e=[this.tag.EngUnitMin,this.tag.EngUnitMax]:null!=this.minMaxValues&&this.minMaxValues.min!=this.minMaxValues.max?(this.usingMinMax=!0,e=[this.minMaxValues.min,this.minMaxValues.max]):null!=this.zoomValues?e=[this.zoomValues.from,this.zoomValues.to]:this.options.minMax&&this.options.minMax[0]!==this.options.minMax[1]?e=[this.options.minMax[0],this.options.minMax[1]]:(e=d3.extent(i.length>0?i:[0]),this.scaleIndex>-1?e=this.adjustRange(e):(this.options.useDataAlone&&(e=this.adjustRange(e)),this.usingMinMax&&(this.options.minMax[0]=e[0],this.options.minMax[1]=e[1]))),this.options.orientation){case t.Orientation.Horizontal:this.func.range([0,this.chart.width]).domain(e);break;case t.Orientation.Vertical:var n=this.chart.height,a=n,r=0;if("STACKED"===this.options.type){for(var o=this.chart.data.length,c=0;c<this.chart.data.length;c++)!1===this.chart.data[c].visible&&o--;var h=(n-12*(o-1))/o;o>1&&(a=this.chart.height-(h*s.updateIndex+12*s.updateIndex),r=a-h)}this.func.range([a,r]).domain(e)}this.values=i,this.stopWatch.logElapsedDuration("value scale "+this.name+" update took: ",!0)},s.prototype.remove=function(){},s}(n);o.updateIndex=0;var c=function(){function e(t){this.chart=t,this.scales={},this.stopWatch=new ww.Utilities.StopWatch,this.chart.scales=this.scales,this.chart.addElement(this)}return e.getInstance=function(t){return e.instance||(e.instance=new e(t)),e.instance},e.prototype.createValueScale=function(t,e,i){var n=new o(this.chart,t,e,i);n.update(),this.scales[n.name]=n},e.prototype.createDateTimeScale=function(t,e){var i=new s(this.chart,t,e);i.update(),this.scales[i.name]=i},e.prototype.createOridinalTimeScale=function(t,e){var i=new a(this.chart,t,e);i.update(),this.scales[i.name]=i},e.prototype.createStringScale=function(t,e){var i=new r(this.chart,t,e);i.update(),this.scales[i.name]=i},e.prototype.removeScale=function(t,e){var i=t.name+e;this.scales[i].remove(),delete this.scales[i]},e.prototype.createScale=function(e,i,n){switch(this.stopWatch.start(),e.dataType){case t.AxisDataTypes.Value:this.createValueScale(e,i,n);break;case t.AxisDataTypes.DateTime:this.createDateTimeScale(e,i);break;case t.AxisDataTypes.OrdinalTime:this.createOridinalTimeScale(e,i);break;case t.AxisDataTypes.String:this.createStringScale(e,i)}this.stopWatch.logElapsedDuration("creation of scale "+e.name+" took: ",!0)},e.prototype.update=function(){var t=null;o.updateIndex=0;for(var e in this.scales)t=this.scales[e],t.update(),t.tag&&!1===t.tag.visible||o.updateIndex++},e.prototype.baseType=function(){return"ScalesFactory"},e.prototype.type=function(){return"ScalesFactory"},e}();c.instance=null,t.ScalesFactory=c}(charts||(charts={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),charts;!function(t){"use strict";var e=function(){function t(){}return t.prototype.update=function(){},t.prototype.clear=function(){},t.prototype.baseType=function(){return"Axis"},t.prototype.type=function(){return"Axis"},t}();t.Axis=e;var i=function(e){function i(i,n,s){var a=e.call(this)||this;return a.chart=i,a.options=n,a.scaleIndex=s,a.stopWatch=null,a.axisGrp=null,a.axisGrpTitle=null,a.dtFormat=null,a.tickValues=[],a.scaleName="",a.axis=null,a.stopWatch=new ww.Utilities.StopWatch,t.ScalesFactory.getInstance(i).createScale(n,s,null),a.chart.options.dateTimeFormat&&a.chart.options.dateTimeFormat.length>0&&(a.dtFormat=d3.time.format(a.chart.options.dateTimeFormat)),a.scaleName=n.name+s,a.createAxisGrpInSvg(),a.update(),a}return __extends(i,e),i.prototype.createAxisGrpInSvg=function(){var t=this.chart.g.selectAll(".xaxis"),e=!0===t.empty()?this.chart.g.append("g").attr("class","axis xaxis"):t;if(!e.empty()){var i=e.selectAll("."+this.scaleName);this.axisGrp=!0===i.empty()?e.append("g").attr("class",this.scaleName):i,this.axisGrpTitle=!0===this.axisGrp.selectAll(".xaxis-title").empty()?this.axisGrp.append("text").attr("class","xaxis-title"):this.axisGrp.selectAll(".xaxis-title")}},i.prototype.configureValueTicks=function(t,e,i){var n=i;if(-1===i&&(n=Math.ceil(this.chart.height/50)),n>0){for(var s=t.scales[this.scaleName].func.domain(),a=d3.min(s),r=d3.max(s),o=[],c=n>1?Math.abs((r-a)/(n-1)):0,h=0;h<=n;h++)o.push(a+c*h);return e.tickValues(o),o}},i.prototype.configureDateTicks=function(t,e,i){var n=this;if(i>0){for(var s=t.scales[this.scaleName].func.domain(),a=new Date(d3.min(s)).getTime(),r=new Date(d3.max(s)).getTime(),o=[],c=i>1?Math.round((r-a)/(i-1)):0,h=0;h<=i;h++)o.push(a+c*h);return e.tickValues(o),e.tickPadding(10).tickFormat(function(t){var e=null;return isNaN(t)?null!==n.dtFormat?n.dtFormat(t):t.toLocaleDateString()+", "+t.toLocaleTimeString():(e=new Date(t),null!==n.dtFormat?n.dtFormat(e):e.toLocaleDateString()+", "+e.toLocaleTimeString())}),o}return e.tickPadding(10).tickFormat(ww.Utilities.customTimeFormat),e.tickValues()},i.prototype.alignTicksTextForTileView=function(t){var e=0;t.selectAll(".tick").selectAll("text").each(function(t,i){e+=1,1===e?d3.select(this).attr({style:function(t){return"text-anchor: start"}}):3===e&&d3.select(this).attr({style:function(t){return"text-anchor: end"}})})},i.prototype.insertLinebreaks=function(){var t=null,e=null,i=null;t=d3.select(this),i=t.text().replace(",","").replace(" AM","AM").replace(" PM","PM").split(" "),t.text("");for(var n=0;n<i.length;n++)e=t.append("tspan").text(i[n]),n>0&&e.attr("x",0).attr("dy","15")},i.prototype.pruneTickLabels=function(t,e){var i=this.chart.scales[this.scaleName].func.domain().length,n=Math.ceil(i/10),s=Math.floor(n/2);t.selectAll(".tick").sort(function(t,e){return new Date(t).getTime()-new Date(e).getTime()}).selectAll("text").text(function(t){var i=ww.Utilities.customTimeFormat(new Date(t)),a=i.substr(0,2);return"HOUR"===e&&parseInt(a)%n==0?i:"DAY"===e&&++s%n==0?i:""})},i.prototype.baseType=function(){return e.prototype.baseType.call(this)},i.prototype.type=function(){return"XAxis"},i.prototype.zoom=function(e,i){switch(this.chart.scales[this.scaleName].func.domain([e,i]),this.chart.options.animationType){case t.AnimationTypes.None:break;default:this.axisGrp.attr("transform","translate(0, "+(this.chart.height+5)+")").call(this.axis)}},i.prototype.remove=function(){t.ScalesFactory.getInstance(this.chart).removeScale(this.options,this.scaleIndex),this.axisGrp.selectAll("."+this.scaleName).remove()},i.prototype.isValid=function(){return!0},i.prototype.update=function(){var e=this;this.stopWatch.start("X-axis update started."),this.options=ww.Utilities.objectInArray(this.chart.options.axes,this.options.name,"name");var i=this.scaleName,n=this.chart.scales[this.scaleName];this.options=n.options;var s=this.options.labelsAngles||0,a=this.options.ticksLength||10;if(!this.options.visible)return this.axisGrp.selectAll("*").remove(),void(this.chart.margin.bottom=5);if(null!==n.func){switch(null===this.axis&&(this.axis=d3.svg.axis().scale(n.func).orient("bottom")),0===this.options.ticks&&(this.axis.ticks(0),this.tickValues=[]),i=this.options.visible?i:i+" hidden ",this.axisGrp.attr("class",i),n.options.dataType){case t.AxisDataTypes.Value:this.tickValues=this.configureValueTicks(this.chart,this.axis,this.options.ticks);break;case t.AxisDataTypes.DateTime:this.tickValues=this.configureDateTicks(this.chart,this.axis,this.options.ticks)}switch(this.chart.options.animationType){case t.AnimationTypes.None:this.axisGrp.attr("transform","translate(0, "+(this.chart.height+5)+")").call(this.axis);break;default:this.axisGrp.attr("transform","translate(0, "+(this.chart.height+5)+")").transition().call(this.axis)}this.axisGrpTitle.attr({x:this.chart.width/2,y:this.chart.margin.bottom-this.chart.legend.calculateHeight()-12}).text(function(){return e.options.title});var r=this.axisGrpTitle.node(),o=r.getBBox().width,c=o>this.chart.width?0:(this.chart.width-o)/2;this.axisGrpTitle.attr("x",c),0!==s&&this.axisGrp.selectAll(".tick").selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate("+s+")").text(function(t){return t.length>a?t.substr(0,a-3)+"...":t}),n.options.dataType===t.AxisDataTypes.OrdinalTime&&this.pruneTickLabels(this.axisGrp,this.options.timeAggregate),this.options.hideLine?this.axisGrp.selectAll("path").attr("opacity",0):this.axisGrp.selectAll("path").attr("opacity",1),3===this.options.ticks&&n.options.dataType===t.AxisDataTypes.DateTime&&this.alignTicksTextForTileView(this.axisGrp),!0===n.options.dateTimeMultiline&&this.chart.svg.selectAll("g.xaxis g text").each(this.insertLinebreaks),this.stopWatch.logElapsedDuration("X-axis update completed. Took: ",!0)}},i}(e);t.XAxis=i}(charts||(charts={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),charts;!function(t){"use strict";var e=function(e){function i(i,n,s,a){var r=e.call(this)||this;return r.chart=i,r.options=n,r.scaleIndex=s,r.tag=a,r.axisCls="axis yaxis",r.scaleName="y",r.axisGrp=null,r.stopWatch=new ww.Utilities.StopWatch,r.tickValues=[],r.isObsolete=!1,r.axis=null,r.currentAxisGrp=null,t.ScalesFactory.getInstance(r.chart).createScale(n,r.scaleIndex,a),r.axisGrp=!0===r.chart.g.selectAll(".yaxis").empty()?r.chart.g.append("g").attr("class",r.axisCls):r.chart.g.selectAll(".yaxis"),r.scaleName=s>-1?n.name+r.scaleIndex:n.name,r}return __extends(i,e),i.prototype.createGrp=function(){var t=!0===this.axisGrp.selectAll("."+this.scaleName).empty()?this.axisGrp.append("g").attr({class:this.scaleName,mode:this.options.type}):this.axisGrp.selectAll("."+this.scaleName);return t.attr("mode")!==this.options.type&&(t.selectAll("*").remove(),t.attr("class",this.scaleName+" "+this.options.type),t.attr("mode",this.options.type)),t},i.prototype.createTitleNode=function(t,e){var i=!0===t.selectAll(".yaxis-title").empty()?t.append("text").attr("class","yaxis-title").attr("text-anchor","end").attr("transform","rotate("+e.toString()+")"):t.selectAll(".yaxis-title");return t.attr("transform","translate(-5, 0)"),i},i.prototype.getTickValues=function(e,i,n,s){var a=s,r=[];if(0===a)return r;switch(this.options.dataType){case t.AxisDataTypes.String:r=d3.range(e.length);break;case t.AxisDataTypes.Value:var o=a;if(-1===a&&(o=Math.ceil(n/50)),o>0){var c=d3.min(i),h=d3.max(i),l=0;!this.options.minMax||this.options.minMax.length<2?(c=d3.min(i),h=d3.max(i)):(this.tag&&this.tag.EngUnitMax!=this.tag.EngUnitMin?(c=this.tag.EngUnitMin,h=this.tag.EngUnitMax):(c=this.options.minMax[0],h=this.options.minMax[1]),i[0]=c,i[1]=h),l=o>1?Math.abs((h-c)/(o-1)):0;for(var u=1;u<=o;u++)1==u?r.push(c):u==o?r.push(h):r.push(c+l*(u-1))}}return r},i.prototype.createD3Axis=function(t,e,i){var n=d3.svg.axis().scale(e).orient("left");return"MULTI"===this.options.type&&n.tickSize(0).tickPadding(5),n.ticks(i.length),n.tickValues(i),t.call(n),n},i.prototype.createSingleYAxis=function(t,e){var n=this,s=this.chart.scales[this.scaleName],a=s.func;if(null!==a){var r=a.range(),o=a.domain(),c=d3.max(r)-d3.min(r);if(this.currentAxisGrp=this.createGrp(),!1!==i.drawScale){i.drawScale=!1;var h=this.createTitleNode(this.currentAxisGrp,-90),l=this.getTickValues(t,o,c,this.options.ticks);this.axis=this.createD3Axis(this.currentAxisGrp,a,l),h.attr({x:-(d3.max(r)-c/2),y:15-this.chart.margin.left}).text(function(){return n.options.title});var u=h.node(),p=u.getBBox().height,f=p>c?-c:-(d3.max(r)-this.chart.margin.top-(c-p)/2-12*this.scaleIndex);if(h.attr("x",f),0===s.values.length){this.currentAxisGrp.selectAll(".tick").remove()}}}},i.prototype.createStackedYAxis=function(t,e){var i=this,n=this.chart.scales[this.scaleName],s=n.func;if(null!==s){var a=s.range(),r=s.domain(),o=d3.max(a)-d3.min(a);this.currentAxisGrp=this.createGrp();var c=this.createTitleNode(this.currentAxisGrp,0),h=this.getTickValues(t,r,o,2);this.createD3Axis(this.currentAxisGrp,s,h),this.axisCls=this.options.visible?"axis yaxis":"axis yaxis hidden",this.axisGrp.attr("class",this.axisCls),c.attr({x:0,y:this.chart.margin.left+15}).text(function(){return t[0][i.options.title]});var l=c.node(),u=l.getBBox().height,p=u>o?o:d3.max(a)-(o-u)/2;if(c.attr({x:-u,y:p}),0===this.chart.scales[this.scaleName].values.length){this.currentAxisGrp.selectAll(".tick").remove()}}},i.prototype.isValid=function(){return!(this.scaleIndex>this.chart.data.length-1)},i.prototype.remove=function(){t.ScalesFactory.getInstance(this.chart).removeScale(this.options,this.scaleIndex),this.axisGrp.selectAll("."+this.scaleName).remove()},i.prototype.createAxisInMultiYAxis=function(t){var e=this,i=this.chart.scales[this.scaleName],n=i.func;if(null!==n){var s=n.range(),a=n.domain(),r=d3.max(s)-d3.min(s);this.currentAxisGrp=this.createGrp();var o=(this.createTitleNode(this.currentAxisGrp,0),this.getTickValues(t,a,r,2));null===this.axis&&(this.axis=this.createD3Axis(this.currentAxisGrp,n,o));var c=this.chart.width/(this.chart.data.length+1),h=c*(this.scaleIndex+1),l=d3.extent(a),u=this.currentAxisGrp.select(".yaxis-title");u.attr("text-anchor","start").attr({x:0,y:-5});var p=this.currentAxisGrp.select(".yaxis-title-rect");p.empty()&&(p=this.currentAxisGrp.append("rect").attr({x:"-10",y:"-20",height:"16px",width:"6px",class:"yaxis-title-rect",fill:t[0].Color})),p.attr({fill:t[0].Color}),u.text(function(){return t[0][e.options.title]}),this.currentAxisGrp.attr("transform","translate("+h+", 0)").call(this.axis);var f=this.currentAxisGrp.selectAll(".tick"),d=this;0===this.chart.scales[this.scaleName].values.length?f.remove():f.each(function(t,e){var i=d3.select(this),n=d3.transform(i.attr("transform")),s=(n.translate[0],n.translate[1]),a=s>=d.chart.height/2?d3.min(l):d3.max(l);a=a%1==0?a:Math.round(1e3*a)/1e3,s>=d.chart.height/2?i.select("text").attr({dy:"-0.5em",x:0}).style({"text-anchor":"middle"}).text(a):i.selectAll("text").attr({dy:"1em",x:0}).style({"text-anchor":"middle"}).text(a)})}},i.prototype.updateAxis=function(){this.stopWatch.start("Y-axis update started");var t=this.chart.scales[this.scaleName];if(this.options=t.options,!this.options.visible||this.options.justScale)return this.axisGrp.selectAll("*").remove(),void(this.chart.margin.left=5);if(!1===this.tag.visible)return void this.axisGrp.selectAll("."+this.scaleName).remove();"STACKED"===this.options.type&&this.currentAxisGrp&&(this.currentAxisGrp.selectAll(".tick").style({fill:this.tag.Color}),this.currentAxisGrp.selectAll("path").style({stroke:this.tag.Color})),this.axisCls=this.options.visible?"axis yaxis":"axis yaxis hidden",this.axisGrp.attr("class",this.axisCls);var e=this.chart.data||[];e="SINGLE"===this.options.type?e:e[this.scaleIndex],Array.isArray(e)||(e=[e]),"MULTI"===this.options.type?this.createAxisInMultiYAxis(e):"STACKED"===this.options.type?this.createStackedYAxis(e,this.scaleIndex):this.createSingleYAxis(e,this.scaleIndex),this.stopWatch.logElapsedDuration("Y-axis update completed. Took: "),this.stopWatch.reset()},i.prototype.zoom=function(t,e){if(this.currentAxisGrp&&this.axis)if("SINGLE"===this.options.type)0===this.scaleIndex&&this.currentAxisGrp.call(this.axis);else{var i=this;this.currentAxisGrp.call(this.axis).selectAll(".tick").each(function(t,e){i.options.minMax.indexOf(t)<0&&this.remove()})}},i.prototype.update=function(){this.updateAxis()},i}(t.Axis);e.drawScale=!0,t.YAxis=e;var i=function(){function i(t){var e=this;this.chart=t,this.axes={},this.children=[],this.stopWatch=new ww.Utilities.StopWatch,this.chart.axes=this.axes,t.options.axes.forEach(function(t){e.CreateAxis(t)}),this.chart.addElement(this)}return i.prototype.CreateAxis=function(e){var i=this;switch(e.orientation){case t.Orientation.Horizontal:this.CreateXAxis(e,0);break;case t.Orientation.Vertical:this.chart.data.forEach(function(t,n){i.CreateYAxis(e,n,t)})}},i.prototype.CreateXAxis=function(e,i){var n=null;return e.justScale||(n=new t.XAxis(this.chart,e,i),this.axes[e.name+0]=n,n.update(),this.children.push(n)),n},i.prototype.CreateYAxis=function(t,i,n){var s=null;return t.justScale||(s=new e(this.chart,t,i,n),s.update(),this.axes[t.name+i]=s,this.children.push(s)),s},i.prototype.removeObsoleteAxis=function(t){var e=this.axes[t],i=ww.Utilities.arrayObjectIndexOf(this.children,t,"axisName");this.children.splice(i,1),e.remove(),delete this.axes[t]},i.prototype.calcTitleLengths=function(t){var e=0;return this.chart.g.select(".yaxis").selectAll(".yaxis-title").each(function(){angular.isDefined(this)&&e<this.getBBox()[t]&&(e=this.getBBox()[t])}),e},i.prototype.calculateLeftMarginValue=function(){var t=0;this.chart.g.select(".yaxis").selectAll(".tick").selectAll("text").each(function(){angular.isDefined(this)&&t<this.getBBox().width&&(t=this.getBBox().width)});var e=0;return"STACKED"===this.chart.options.axes[0].type?e=this.calcTitleLengths("width"):"SINGLE"===this.chart.options.axes[0].type&&(e=this.calcTitleLengths("height")),t+25+e},i.prototype.updateAxes=function(){var i=this;e.drawScale=!0,this.chart.options.axes.forEach(function(e){i.chart.data.forEach(function(n,s){var a=e.name+s;if(a in i.axes){var r=i.axes[a];r.isValid()?r.update():i.removeObsoleteAxis(a)}else{var r=null;switch(e.orientation){case t.Orientation.Vertical:r=i.CreateYAxis(e,s,null)}}})})},i.prototype.update=function(){if(this.updateAxes(),"MULTI"!==this.chart.options.axes[0].type){var t=this.calculateLeftMarginValue();this.chart.margin.left!==t&&(this.chart.margin.left=t,this.chart.update(!1),this.updateAxes())}},i.prototype.baseType=function(){return"AxesFactory"},i.prototype.type=function(){return"AxesFactory"},i}();t.AxesFactory=i;var n=function(){function t(){this.restrict="E",this.link={pre:this.pre}}return t.instance=function(){return new t},t.prototype.pre=function(t,e,n){var s=t.canvas;new i(s)},t}();n.$inject=[""],angular.module("ww").directive("wwAxes",n.instance)}(charts||(charts={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),charts;!function(t){"use strict";var e=function(){function t(){}return t.prototype.update=function(){},t.prototype.baseType=function(){return"GenericGrid"},t.prototype.type=function(){return"GenericGrid"},t}();t.GenericGrid=e;var i=function(e){function i(i){var n=e.call(this)||this;n.chart=i,n.stopWatch=new ww.Utilities.StopWatch,n.group=null,n.isObsolete=!1,n.mode=t.Orientation.Horizontal;var s=n.chart.options.grid;return n.mode=s.mode,n.horizontalAxis=s.horizontalAxis,n.verticalAxis=s.verticalAxis,n.group=n.chart.g.selectAll(".grid-group").empty()?n.chart.g.append("g").attr("class","grid-group").attr("transform","translate(0, 0)"):n.chart.g.selectAll(".grid-group"),n}return __extends(i,e),i.prototype.drawGrids=function(t){},i.prototype.baseType=function(){return e.prototype.baseType.call(this)},i.prototype.type=function(){return"Grid"},i.prototype.zoom=function(t){this.update()},i.prototype.update=function(){var e=this;this.stopWatch.start();var i=ww.Utilities.objectInArray(this.chart.options.axes,"y","name");this.mode=this.chart.options.grid.mode;var n,s=null,a=null,r=null,o=null,c=this.mode,h=[],l=[],u=null;if(this.group.selectAll("*").remove(),this.chart.options.grid.visible){if(c===t.Orientation.Horizontal||c===t.Orientation.Both)if(n={cls:"hgrid",id:""},"MULTI"===i.type){if(s=this.chart.scales[this.horizontalAxis],a=this.chart.scales[this.verticalAxis],r=angular.isDefined(this.horizontalAxis)?this.chart.axes[this.horizontalAxis]:this.horizontalAxis,o=angular.isDefined(this.verticalAxis)?this.chart.axes[this.verticalAxis+0]:this.verticalAxis+0,!(s&&a&&r&&o))return;if(h=[],void 0===a)return void this.group.selectAll(".vgrid").remove();if(n={cls:"hgrid",id:"y0"},this.group.selectAll("."+n.cls).remove(),null===a.func)return;for(var p=a.func.domain(),f=p[1]-p[0],d=p[0],m=f/4,v=0;v<=4;v++)h.push(d),d+=m;u=a.func.domain(),-1===h.indexOf(u[0])&&h.push(u[0]),h&&(n.line=this.group.selectAll("."+n.cls).filter("."+n.id).data(h),n.coords={x1:0,x2:this.chart.width,y1:a.func},n.coords.y2=n.coords.y1,l.push(n))}else{s=this.chart.scales[this.horizontalAxis];for(var y in this.chart.scales)if(!(y.indexOf("x")>=0)&&(n={cls:"hgrid",id:y},(a=this.chart.scales[y])&&!1!==a.tag.visible)){if(r=angular.isDefined(this.horizontalAxis)?this.chart.axes[this.horizontalAxis]:this.horizontalAxis,o=angular.isDefined(y)?this.chart.axes[y]:y,null===a.func)return;h=o.tickValues.length>0?o.tickValues:a.func.ticks(),u=a.func.domain(),-1===h.indexOf(u[0])&&h.push(u[0]),h&&(n.line=this.group.selectAll("."+n.cls).filter("."+n.id).data(h),n.coords={x1:0,x2:this.chart.width,y1:a.func},n.coords.y2=n.coords.y1,l.push(n))}}if(c===t.Orientation.Vertical||c===t.Orientation.Both){if(s=this.chart.scales[this.horizontalAxis],a=this.chart.scales[this.verticalAxis],r=angular.isDefined(this.horizontalAxis)?this.chart.axes[this.horizontalAxis]:this.horizontalAxis,o=angular.isDefined(this.verticalAxis)?this.chart.axes[this.verticalAxis]:this.verticalAxis,!s||null===s.func)return;n={cls:"vgrid",id:""},h=angular.isDefined(r)&&angular.isDefined(r.tickValues)?r.tickValues:s.func.ticks(),u=s.func.domain(),null===h&&(h=[]),-1===h.indexOf(u[0])&&h.push(u[0]),-1===h.indexOf(u[1])&&h.push(u[1]),h&&(n.line=this.group.selectAll("."+n.cls).data(h),n.coords={x1:s.func,y1:this.chart.height,y2:0},n.coords.x2=n.coords.x1,l.push(n))}l.forEach(function(t){t.line.enter().append("line").attr("class","grid "+t.cls+" "+t.id).style(e.chart.options.grid.style),t.line.exit().remove(),t.line.attr(t.coords).style(e.chart.options.grid.style)}),this.stopWatch.logElapsedDuration("grid update took: "),this.stopWatch.reset()}},i}(e);t.Grid=i;var n=function(){function t(){this.stopWatch=new ww.Utilities.StopWatch}return t.CreateGrids=function(t){var e=new i(t);e.update(),t.addElement(e)},t}();t.GridsFactory=n;var s=function(){function t(){this.restrict="E",this.link={pre:this.pre}}return t.instance=function(){return new t},t.prototype.pre=function(t,e,i){var s=t.canvas;n.CreateGrids(s)},t}();s.$inject=[""],angular.module("ww").directive("wwGrid",s.instance)}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function t(t,e){this.x=t,this.y=e}return t}(),i=function(){function t(){this.text="",this.values=[]}return t}(),n=function(){function t(t){this.chart=t,this.stopWatch=new ww.Utilities.StopWatch,this.xScale=null,this.yScale=null,this.group=null,this.isObsolete=!1,this.options=null,this.options=this.chart.options,this.xScale=this.chart.scales[this.options.limitLines[0].xaxisScale+0];var e=this.options.limitLines[0].yaxisScale+0;ww.Utilities.objectInArray(this.chart.options.axes,e,"name");this.yScale=this.chart.scales[e],this.group=!0===this.chart.g.selectAll(".limitlines-group").empty()?this.chart.g.append("g").attr("class","limitlines-group"):this.chart.g.selectAll(".limitlines-group"),this.group.attr("clip-path","url("+document.location.toString()+"#"+this.chart.clipPathId+")")}return t.prototype.baseType=function(){return"LimitLines"},t.prototype.type=function(){return"LimitLines"},t.prototype.createLimitLine=function(t){var n=this;this.yScale=this.chart.scales[this.options.limitLines[0].yaxisScale+t];var s=d3.svg.line().x(function(t){return t.x}).y(function(t){return n.yScale.func(t.y)}).interpolate("linear");if(null!==this.xScale.func&&null!==this.yScale.func){var a=[];this.chart.options.limitLines.forEach(function(t){var s=new i;s.text=t.text,
s.values.push(new e(0,t.position)),s.values.push(new e(n.chart.width,t.position)),a.push(s)});var r=this.group.selectAll(".limitline").data(a);r.attr({d:function(t){return s(t.values)},stroke:"black"}),r.enter().append("path").attr({class:"limitline",d:function(t){return s(t.values)},fill:"none",stroke:"black","stroke-width":1}),r.exit().remove();var o=this,c=this.group.selectAll(".limitline-title").data(a);c.attr({x:function(){var t=d3.select(this).node(),e=t.getBBox().width;return e>=o.chart.width?0:(o.chart.width-e)/2},y:function(t){return n.yScale.func(t.values[0].y)-5}}),c.enter().append("text").attr("class","limitline-title").attr({x:function(){var t=d3.select(this).node(),e=t.getBBox().width;return e>=o.chart.width?0:(o.chart.width-e)/2},y:function(t){return n.yScale.func(t.values[0].y)-5}}).text(function(t){return t.text}),c.text(function(t){return t.text})}},t.prototype.update=function(){if(this.stopWatch.start("Limit lines started."),this.options=this.chart.options,!1!==this.chart.options.limitLines[0].visible){if("SINGLE"!==this.yScale.options.type||0===this.chart.options.limitLines.length)return void(this.group.empty()||this.group.selectAll("*").remove());this.createLimitLine(0),this.stopWatch.logElapsedDuration("Limit lines completed. Took: ",!0)}},t}(),s=function(){function t(){}return t.CreateLimitLines=function(t){var e=(new ww.Utilities.StopWatch,new n(t));e.update(),t.addElement(e)},t}();t.LimitLinesFactory=s;var a=function(){function t(){this.restrict="E",this.link={pre:this.pre}}return t.instance=function(){return new t},t.prototype.pre=function(t,e,i){var n=t.canvas;s.CreateLimitLines(n)},t}();a.$inject=[""],angular.module("ww").directive("wwLimitLines",a.instance)}(charts||(charts={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),charts;!function(t){"use strict";var e=function(){function t(){}return t.prototype.update=function(){},t.prototype.baseType=function(){return"GenericLines"},t.prototype.type=function(){return"GenericLines"},t}();t.GenericLines=e;var i=function(e){function i(t,i){var n=e.call(this)||this;n.chart=t,n.scaleIndex=i,n.xBasedOn="",n.yBasedOn="",n._count=0,n.xScale=null,n.yScale=null,n.linesInfo=null,n.group=null,n.stopWatch=new ww.Utilities.StopWatch,n.isObsolete=!1,n.bisect=d3.bisector(function(t){return new Date(t.DateTime)}).right;var s=n.chart.options.lines.xaxisScale+0,a=n.chart.options.lines.yaxisScale+n.scaleIndex;return n.xScale=n.chart.scales[s],n.yScale=n.chart.scales[a],n.group=n.chart.g.selectAll(".lines-group").empty()?n.chart.g.append("g").attr("class","lines-group").attr("transform","translate(0, 0)"):n.chart.g.selectAll(".lines-group"),n.group.attr("clip-path","url("+document.location.toString()+"#"+n.chart.clipPathId+")"),n}return __extends(i,e),i.prototype.getInterpolationMode=function(t){var e="linear";switch(t){case"Linear":e="linear";break;case"StairStep":e="step-after"}return e},i.prototype.lineDefination=function(t,e,i){return null===t[e]||null===t[i]?null:t},i.prototype.line=function(e,i){var n=this;return d3.svg.line().defined(function(t){return n.lineDefination(t,n.xBasedOn,n.yBasedOn)}).interpolate(this.getInterpolationMode(i)).x(function(e){return n.xScale.options.dataType===t.AxisDataTypes.Value?n.xScale.func(e[n.xBasedOn]):n.xScale.options.dataType===t.AxisDataTypes.DateTime?n.xScale.func(ww.Utilities.parseDate(e[n.xBasedOn])):void 0}).y(function(e){if(n.yScale.options.dataType===t.AxisDataTypes.Value){var i=e[n.yBasedOn];return n.yScale.func(null===i||void 0===i?0:i)}if(n.yScale.options.dataType===t.AxisDataTypes.DateTime)return n.yScale.func(ww.Utilities.parseDate(e[n.yBasedOn]))})(e)},i.prototype.areaUnderLine=function(e,i){var n=this;return d3.svg.area().defined(function(t){return n.lineDefination(t,n.xBasedOn,n.yBasedOn)}).interpolate(this.getInterpolationMode(i)).x(function(e){return n.xScale.options.dataType===t.AxisDataTypes.Value?n.xScale.func(e[n.xBasedOn]):n.xScale.options.dataType===t.AxisDataTypes.DateTime?n.xScale.func(ww.Utilities.parseDate(e[n.xBasedOn])):void 0}).y0(function(){return n.yScale.func.range()[0]}).y1(function(e){if(n.yScale.options.dataType===t.AxisDataTypes.Value){var i=e[n.yBasedOn];return n.yScale.func(null===i||void 0===i?0:i)}if(n.yScale.options.dataType===t.AxisDataTypes.DateTime)return n.yScale.func(ww.Utilities.parseDate(e[n.yBasedOn]))})(e)},i.prototype.areAllValuesNull=function(t,e){var i=!0;return angular.isDefined(t.values)&&t.values.length>0&&$(t.values).each(function(t,n){if(null!==n[e])return void(i=!1)}),i},i.prototype.markLastPoint=function(e){var i=this;if(this.linesInfo.highlightLastPoint){var n=this.group.selectAll(".lastPointMark").data(e,function(t,e){return t.FQN+" "+e}),s=function(e){if(angular.isDefined(e.values)&&e.values.length>0){var n,s=e.values.length;return i.xScale.options.dataType===t.AxisDataTypes.Value?n=e.values[s-1][i.xBasedOn]:i.xScale.options.dataType===t.AxisDataTypes.DateTime&&(n=ww.Utilities.parseDate(e.values[s-1][i.xBasedOn])),isNaN(i.xScale.func(n))?0:i.xScale.func(n)}},a=function(e){var n,s=e.values.length;if(angular.isDefined(e.values)&&e.values.length>0)return i.yScale.options.dataType===t.AxisDataTypes.Value?n=e.values[s-1][i.yBasedOn]:i.yScale.options.dataType===t.AxisDataTypes.DateTime&&(n=ww.Utilities.parseDate(e.values[s-1][i.yBasedOn])),isNaN(i.yScale.func(n))?0:i.yScale.func(n)};n.enter().append("circle").attr("class","lastPointMark").attr({cx:function(t){return s(t)},r:3,cy:function(t){return a(t)},visibility:function(t){return i.areAllValuesNull(t,"Value")?"hidden":"visible"}}),n.attr({cx:function(t){return s(t)},r:3,cy:function(t){return a(t)},visibility:function(t){return i.areAllValuesNull(t,"Value")?"hidden":"visible"}}),n.exit().remove()}},i.prototype.fillAreaUnderTrendLine=function(t){var e=this;if(this.linesInfo.fillArea){var i=this.group.selectAll(".areaUnderTrendLine").data(t,function(t,e){return t.FQN+" "+e});i.enter().append("path").attr({class:"areaUnderTrendLine",d:function(t){return e.areaUnderLine(t.values,t.InterpolationType)}}),i.attr("d",function(t){return e.areaUnderLine(t.values,t.InterpolationType)}),i.exit().remove()}},i.prototype.createLines=function(t,e,i,n,s){var a=this;if(e && null!==e.func&&null!==i.func){if(!this.linesInfo.visible)return void this.group.selectAll("*").remove();if(n.length&&!1===n[0].visible)return void this.group.selectAll("."+i.name).remove();var r=this.group.selectAll("."+i.name).data(n,function(t,e){return t.FQN});r.exit().remove(),r.enter().append("g").attr({class:"sub-lines-group "+i.name,transform:"translate(0, 0)"}),r.selectAll(".line").remove();var o=r.selectAll(".line").data(n);o.attr({d:function(t){return void 0!==t.values&&t.values.length>0&&!1!==t.visible?a.line(t.values,t.InterpolationType):"M 0 0"},stroke:function(t){return t.Color}}).style(s),o.enter().append("path").attr({class:"line",xScale:e.name,yScale:i.name,stroke:function(t){return t.Color},d:function(t){return void 0!==t.values&&t.values.length>0?a.line(t.values,t.InterpolationType):"M 0 0"}}).style(s)}},i.prototype.remove=function(t){this.group.selectAll(".y"+t).remove(),this.chart.removeElement(this)},i.prototype.zoom=function(){var t=this,e=null!==this.chart.data?[this.chart.data[this.scaleIndex]]:[];this.group.selectAll("."+this.yScale.name).data(e,function(t,e){return t.FQN}).selectAll(".line").data(e).attr({d:function(e){return void 0!==e.values&&e.values.length>0&&!1!==e.visible?t.line(e.values,e.InterpolationType):"M 0 0"}})},i.prototype.baseType=function(){return e.prototype.baseType.call(this)},i.prototype.type=function(){return"Lines"},i.prototype.update=function(){this.stopWatch.start("lines update started.");var t=this.chart.options.lines.xaxisScale+0,e=this.chart.options.lines.yaxisScale+this.scaleIndex;if(this.scaleIndex>this.chart.data.length-1)return void this.remove(this.scaleIndex);this.xScale=this.chart.scales[t],this.yScale=this.chart.scales[e],(this.xScale||this.yScale)&&(this.xBasedOn=this.xScale.options.basedOn,this.yBasedOn=this.yScale.options.basedOn),this.linesInfo=this.chart.options.lines;var i=null!==this.chart.data?[this.chart.data[this.scaleIndex]]:[];this.createLines(this.group,this.xScale,this.yScale,i,this.linesInfo.style),this.fillAreaUnderTrendLine(i),this.markLastPoint(i),this.stopWatch.logElapsedDuration("lines update complete. Took: ",!0)},i.prototype.seekPos=function(t,e){for(var i,n,s=t.node().getTotalLength(),a=0,r=s;;){if(n=Math.floor((a+r)/2),i=t.node().getPointAtLength(n),(n===r||n===a)&&i.x!==e)break;if(i.x>e)r=n;else{if(!(i.x<e))break;a=n}}return i},i.prototype.updateScooterValues=function(t,e){var i,n=d3.event;i=null!==n?n.pageX:e;var s=[],a=this;return this.chart.g.selectAll(".line").each(function(){var n,s=d3.select(this),r=a.chart.scales[s.attr("yScale")],o=(s.attr("stroke"),s.data()[0]),c=s.style("opacity"),h=a.xScale.func.invert(e),l=a.bisect(o.values,h),u=o.values[l-1],p=o.values[l],f="",d=o.decimalDigits||0===o.decimalDigits?o.decimalDigits:3,m=Math.pow(10,d);if(angular.isDefined(p)&&null===p.Value||angular.isDefined(u)&&null===u.Value)angular.isDefined(u)&&null!==u.Value&&a.xScale.func(h)-a.xScale.func(new Date(u.DateTime))<1&&(n={},n.x=a.xScale.func(new Date(u.DateTime)),n.y=a.yScale.func(u.Value),f=(Math.round(u.Value*m)/m).toString()),angular.isDefined(p)&&null!==p.Value&&a.xScale.func(new Date(p.DateTime))-a.xScale.func(h)<1&&(n={},n.x=this.xScale.func(new Date(p.DateTime)),n.y=this.yScale.func(p.Value),f=(Math.round(p.Value*m)/m).toString());else{var v=s.node();i-$(v).offset().left-2<=v.getBoundingClientRect().width&&(n=a.seekPos(s,e),e-n.x>2?n=void 0:f=(Math.round(r.func.invert(n.y)*m)/m).toString())}t.some(function(t){if(t.fqn===o.FQN)return t.position=n,t.value=f.length>0?f+" "+t.EngUnit:"",t.visibility="1"===c?"":"none",!0})}),s},i}(e),n=function(){function t(t){var e=this;this.chart=t,this.stopWatch=new ww.Utilities.StopWatch,this.chart.addElement(this),t.data.forEach(function(t,i){e.createLine(i)})}return t.prototype.createLine=function(t){var e=new i(this.chart,t);e.update(),this.chart.addElement(e)},t.prototype.update=function(){},t}();t.LinesFactory=n;var s=function(){function t(){this.restrict="E",this.link={pre:this.pre}}return t.instance=function(){return new t},t.prototype.pre=function(t,e,i){var s=t.canvas;new n(s)},t}();s.$inject=[""],angular.module("ww").directive("wwLines",s.instance)}(charts||(charts={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),charts;!function(t){"use strict";var e=function(){function t(){}return t.prototype.update=function(){},t.prototype.baseType=function(){return"GenericCircles"},t.prototype.type=function(){return"GenericCircles"},t}();t.GenericCircles=e;var i=function(t){function e(e){var i=t.call(this)||this;return i.chart=e,i.g=null,i.group=null,i.stopWatch=null,i.stopWatch=new ww.Utilities.StopWatch,i.g=i.chart.g,i.group=i.g.selectAll(".circles-group").empty()?i.g.append("g").attr("class","circles-group").attr("transform","translate(0, 0)"):i.g.selectAll(".circles-group"),i}return __extends(e,t),e.prototype.baseType=function(){return t.prototype.baseType.call(this)},e.prototype.type=function(){return"Circles"},e.prototype.update=function(){var t=this;this.stopWatch.start();var e=this.chart.scales[this.chart.options.circles.xaxisScale],i=this.chart.scales[this.chart.options.circles.yaxisScale],n=[],s=this.chart.options.circles,a=i.options.index;a.length>0?a.forEach(function(e){n.push(t.chart.data[e])}):n=(Array.isArray(this.chart.data),this.chart.data),this.group.selectAll(".circles-group").remove();var r=this.group.selectAll(".circles-group").data(n,function(t,e){return t.FQN+" "+e});r.enter().append("g").attr("class","circles-group"),r.exit().transition().duration(350).remove();var o=r.selectAll(".circle").data(function(t,e){return t.values});o.enter().append("circle").attr({class:"circle",r:s.r,cx:function(t){return e.func(t[s.cx])},cy:function(t){return i.func(t[s.cy])},stroke:function(t){return ww.Utilities.objectInArray(n,t.FQN,"FQN").Color}}).style(s.style),o.transition().ease("linear").attr({cx:function(t){return e.func(t[s.cx])},cy:function(t){return i.func(t[s.cy])},stroke:function(t){return ww.Utilities.objectInArray(n,t.FQN,"FQN").Color}}).style(s.style),this.stopWatch.logElapsedDuration("circles update took: "),this.stopWatch.reset()},e}(e),n=function(){function t(){}return t.CreateCircles=function(t){var e=(new ww.Utilities.StopWatch,new i(t));e.update(),t.addElement(e)},t}();t.CirclesFactory=n}(charts||(charts={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),charts;!function(t){"use strict";var e=function(){function t(){}return t.prototype.update=function(){},t.prototype.baseType=function(){return"Bars"},t.prototype.type=function(){return"Bars"},t}();t.Bars=e;var i=function(t){function e(e){var i=t.call(this)||this;return i.chart=e,i.g=null,i.xScale=null,i.yScale=null,i.group=null,i.stopWatch=null,i.tip=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t){var e=i.xScale.options.basedOn;return"<strong>"+t[e]+"</strong><br><span><strong>"+i.chart.options.vBars.basedOn.capitalizeFirstLetter()+":&nbsp;</strong>"+t[i.chart.options.vBars.basedOn]+"<br><strong>Value:&nbsp;</strong>"+t[e]+"</span>"}),i.stopWatch=new ww.Utilities.StopWatch,i}return __extends(e,t),e.prototype.baseType=function(){return t.prototype.baseType.call(this)},e.prototype.type=function(){return"VBars"},e.prototype.update=function(){var t=this;this.stopWatch.start(),this.g=this.chart.g,this.group=this.g.selectAll(".vbars-group").empty()?this.g.append("g").attr("class","vbars-group").attr("transform","translate(0, 0)"):this.g.selectAll(".vbars-group"),this.xScale=this.chart.scales[this.chart.options.vBars.xaxisScale],this.yScale=this.chart.scales[this.chart.options.vBars.yaxisScale];var e=this.chart.data,i=[],n=this.chart.options.vBars.basedOn,s=this.chart.options.vBars.groupBy||null,a=null!==s?s.split(","):[],r=this.xScale.options.basedOn,o=this.yScale.options.basedOn,c=this.chart.options.vBars.visible;if(e=void 0===e.length?[e]:e,!c)return void this.group.selectAll("*").remove();this.group.call(this.tip);var h=Math.max(this.chart.scales[a[1]].func.rangeBand()-1,0);if(0!==a.length){e.forEach(function(t){t.values.forEach(function(t){i.push(t)})});var l=this.group.selectAll(".bars-subgroup").data(this.chart.scales[a[0]].func.domain());l.enter().append("g").attr("class",function(t){return"g bars-subgroup "+t}).attr("transform",function(e){return"translate("+t.chart.scales[a[0]].func(e)+",0)"}).append("rect").attr({class:"subgroup-line",width:this.chart.scales[a[0]].func.rangeBand(),x:0,y:this.chart.height+2.25,height:1.5}).style("fill","black"),l.exit().remove(),l.attr("transform",function(e){return"translate("+t.chart.scales[a[0]].func(e)+",0)"}).selectAll(".subgroup-line").attr({width:this.chart.scales[a[0]].func.rangeBand(),x:0,y:this.chart.height+2.25}),this.chart.options.vBars.hideSubgroupLines&&l.selectAll(".subgroup-line").style("opacity",0);var u=l.selectAll(".vbar").data(function(t){return i.filter(function(e){if(e[n]===t)return e})});u.enter().append("rect").attr("class","vbar").attr("width",h).attr("x",function(e){return isNaN(t.chart.scales[a[1]].func(e[r]))?0:t.chart.scales[a[1]].func(e[r])}).attr("y",function(e){var i=e[o]<0?t.yScale.func(0):t.yScale.func(e[o]);return isNaN(i)?0:t.chart.height-i}).attr("height",function(t){return 0}).style("fill",function(t){return ww.Utilities.objectInArray(e,t[r],r).Color}),u.exit().remove(),u.attr("width",h).attr("x",function(e){return isNaN(t.chart.scales[a[1]].func(e[r]))?0:t.chart.scales[a[1]].func(e[r])}).attr("y",function(e){var i=e[o]<0?t.yScale.func(0):t.yScale.func(e[o]);return isNaN(i)?0:i}).attr("height",function(e){var i=Math.abs(t.yScale.func(0)-t.yScale.func(e[o]));return isNaN(i)?0:i}).style("fill",function(t){return ww.Utilities.objectInArray(e,t[r],r).Color}),this.chart.options.vBars.tooltip&&u.on("mouseover",function(e){return t.tip.show(e)}).on("mouseout",function(e){return t.tip.hide(e)}),this.chart.options.vBars.drillIn.length>0&&u.attr("pop-up","").attr("src",this.chart.options.vBars.drillIn).attr("show-on-click","true").attr("parent","chartContainer").on("click",function(e){t.selectBar(e,d3.event)}).each(function(t){}),this.stopWatch.logElapsedDuration("chart update took: "),this.stopWatch.reset()}},e.prototype.resetSelection=function(){this.group.selectAll(".bars-subgroup").selectAll(".vbar").style("opacity","1"),ww.popup.curtain&&ww.popup.curtain.get(0).removeEventListener("mouseover",this.resetSelection),ww.popup.hide()},e.prototype.selectBar=function(t,e){e.stopPropagation(),this.group.selectAll(".bars-subgroup").selectAll(".vbar").style("opacity",function(e){return e===t?1:.4}).style("cursor","pointer"),ww.popup.curtain.get(0).addEventListener("mouseover",this.resetSelection)},e}(e),n=function(){function e(){}return e.CreateBars=function(e,n){new ww.Utilities.StopWatch;switch(n){case t.Orientation.Vertical:var s=new i(e);s.update(),e.addElement(s);break;case t.Orientation.Horizontal:var a=new t.HBars(e);a.update(),e.addElement(a)}},e}();t.BarsFactory=n}(charts||(charts={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),charts;!function(t){"use strict";var e=function(t){function e(e){var i=t.call(this)||this;return i.chart=e,i.stopWatch=null,i.stopWatch=new ww.Utilities.StopWatch,i}return __extends(e,t),e.prototype.baseType=function(){return t.prototype.baseType.call(this)},e.prototype.type=function(){return"HBars"},e.prototype.update=function(){var t=this;this.stopWatch.start();var e=this.chart.g.selectAll(".bars-group").empty()?this.chart.g.append("g").attr("class","bars-group").attr("transform","translate(0, 0)"):this.chart.g.selectAll(".bars-group"),i=this.chart.data,n=this.chart.scales[this.chart.options.hBars.xaxisScale],s=this.chart.scales[this.chart.options.hBars.yaxisScale],a=[];if(void 0!==n.func&&void 0!==s.func){i.forEach(function(t){t.values.forEach(function(t){a.push(t)})});var r=e.selectAll("rect").data(a);r.exit().remove(),r.enter().append("rect").attr({class:"hbar",fill:function(t){return ww.Utilities.objectInArray(i,t.FQN,"FQN").Color},height:18,x:n.func(0),y:function(t,e){return 20*e},width:0}),r.attr({fill:function(t){return ww.Utilities.objectInArray(i,t.FQN,"FQN").Color},x:function(t){var e=n.func(0),i=isNaN(t[n.options.basedOn])?0:t[n.options.basedOn];return n.func(i)-n.func(0)<0&&(e=n.func(i)),e},y:function(t,e){return 20*e},width:function(t){var e=isNaN(t[n.options.basedOn])?0:t[n.options.basedOn];return Math.abs(n.func(e)-n.func(0))}}).each(function(t,e){if("events"in t){var i=d3.select(this);Object.keys(t.events).forEach(function(e){i.on(e,t.events[e])})}});var o=e.selectAll("text").data(a);o.exit().remove(),o.enter().append("text").attr({class:"hbar",x:function(t){var e=isNaN(t[n.options.basedOn])?0:t[n.options.basedOn];return n.func(0)+(n.func(e)-n.func(0))/2},y:function(t,e){return 20*e+14}}).text(function(t){return"loading..."===t.status?t.status:isNaN(t[n.options.basedOn])?"NULL":t[n.options.basedOn]}).style({fill:"#ffffff","font-size":"14px"}),o.attr({x:function(t){var e=d3.select(this).node(),i=e.getBBox().width,s=isNaN(t[n.options.basedOn])?0:t[n.options.basedOn],a=(n.func(s)-n.func(0))/2;return a>0?a-i>0?a=a:a-i<=0&&(a=0):a<0&&(Math.abs(a)>i?a=a:Math.abs(a)<i&&(a=0)),n.func(0)+a},y:function(t,e){return 20*e+14}}).text(function(e){return e[t.chart.options.hBars.text]}).style({fill:"#000000","font-size":"12px","font-weight":"bold"}).each(function(t,e){if("events"in t){var i=d3.select(this);Object.keys(t.events).forEach(function(e){i.on(e,t.events[e])})}}),this.stopWatch.logElapsedDuration("Hbars update took: "),this.stopWatch.reset()}},e}(t.Bars);t.HBars=e}(charts||(charts={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),charts;!function(t){"use strict";var e=function(){function t(){}return t.prototype.update=function(){},t.prototype.baseType=function(){return"GenericLinesWithDots"},t.prototype.type=function(){return"GenericLinesWithDots"},t}();t.GenericLinesWithDots=e;var i=function(t){function e(e){var i=t.call(this)||this;return i.chart=e,i.stopWatch=null,i.group=null,i.xScale=null,i.yScale=null,i.tip=null,i.stopWatch=new ww.Utilities.StopWatch,i.group=i.chart.g.selectAll(".linesWithDots-group").empty()?i.chart.g.append("g").attr("class","linesWithDots-group").attr("transform","translate(0, 0)"):i.chart.g.selectAll(".linesWithDots-group"),i}return __extends(e,t),e.prototype.baseType=function(){return t.prototype.baseType.call(this)},e.prototype.type=function(){return"LinesWithDots"},e.prototype.update=function(){var t=this;this.stopWatch.start();var e=this.chart.options.linesWithDots;this.xScale=this.chart.scales[e.xaxisScale],this.yScale=this.chart.scales[e.yaxisScale],this.tip=d3.tip().attr("class","d3-tip tooltip").offset([-10,0]).html(function(e){return"<strong>"+e[t.xScale.options.basedOn]+"</strong><br><span><strong>State:&nbsp;</strong>"+e.state+"<br><span><strong>Max:&nbsp;&nbsp;&nbsp;</strong>"+e.maximum+" </span><br><span><strong>Avg:&nbsp;&nbsp;&nbsp;</strong>"+e.average+" </span><br><span><strong>Min:&nbsp;&nbsp;&nbsp;</strong>"+e.minimum+" </span>"});var i=this.chart.data,n=[],s=e.groupBy||null,a=null!==s?s.split(","):[],r=this.xScale.options.basedOn;if(i=void 0===i.length?[i]:i,!e.visible)return void this.group.selectAll("*").remove();if(i.forEach(function(t){t.values.forEach(function(t){n.push(t)})}),a.length>0){var o=this.group.selectAll(".bars-subgroup").data(this.chart.scales[a[0]].func.domain());o.enter().append("g").attr({class:function(t){return"g bars-subgroup "+t},transform:function(e){return"translate("+t.chart.scales[a[0]].func(e)+",0)"}}).append("rect").attr({class:"subgroup-line",width:this.chart.scales[a[0]].func.rangeBand(),x:0,y:this.chart.height+2.25,height:1.5}).style("fill","black"),o.attr("transform",function(e){return"translate("+t.chart.scales[a[0]].func(e)+",0)"}).selectAll(".subgroup-line").attr({width:this.chart.scales[a[0]].func.rangeBand(),x:0,y:this.chart.height+2.25}),o.exit().remove();var c=o.selectAll(".line").data(function(t){return n.filter(function(e){if(e.state===t)return e})});c.exit().transition().remove(),c.enter().append("line").attr("class","line").attr("x1",function(e){return t.chart.scales[a[1]].func(e[r])+t.chart.scales[a[1]].func.rangeBand()/2}).attr("x2",function(e){return t.chart.scales[a[1]].func(e[r])+t.chart.scales[a[1]].func.rangeBand()/2}).attr("y1",function(t){return t.minimum}).attr("y2",function(e){return t.yScale.func(e.maximum)}).attr("stroke-width",1).attr("opacity",.5).attr("stroke",function(){return"black"}),c.attr("x1",function(e){return t.chart.scales[a[1]].func(e[r])+t.chart.scales[a[1]].func.rangeBand()/2}).attr("x2",function(e){return t.chart.scales[a[1]].func(e[r])+t.chart.scales[a[1]].func.rangeBand()/2}).attr("y1",function(e){return t.yScale.func(e.minimum)}).attr("y2",function(e){return t.yScale.func(e.maximum)});var h=o.selectAll(".minCircle").data(function(t){return n.filter(function(e){if(e.state===t)return e})});h.exit().remove(),h.enter().append("circle").attr("class","minCircle").on("mouseover",this.tip.show).on("mouseout",this.tip.hide).attr("cx",function(e){return t.chart.scales[a[1]].func(e[r])+t.chart.scales[a[1]].func.rangeBand()/2}).attr("cy",function(e){return t.yScale.func(e.minimum)}).attr("r",function(){return 5}).attr("stroke-width",function(){return 1}).attr("stroke",function(){return"black"}).attr("fill",function(t){return ww.Utilities.objectInArray(i,t.FQN,"FQN").Color}),h.attr("cx",function(e){return t.chart.scales[a[1]].func(e[r])+t.chart.scales[a[1]].func.rangeBand()/2}).attr("cy",function(e){return t.yScale.func(e.minimum)}).attr("fill",function(t){return ww.Utilities.objectInArray(i,t.FQN,"FQN").Color}).on("mouseover",this.tip.show).on("mouseout",this.tip.hide);var l=o.selectAll(".maxCircle").data(function(t){return n.filter(function(e){if(e.state===t)return e})});l.exit().remove(),l.enter().append("circle").attr("class","maxCircle").on("mouseover",this.tip.show).on("mouseout",this.tip.hide).attr("cx",function(e){return t.chart.scales[a[1]].func(e[r])+t.chart.scales[a[1]].func.rangeBand()/2}).attr("cy",function(e){return t.yScale.func(e.maximum)}).attr("r",function(){return 5}).attr("stroke-width",function(){return 1}).attr("stroke",function(){return"black"}).attr("fill",function(t){return ww.Utilities.objectInArray(i,t.FQN,"FQN").Color}),l.attr("cx",function(e){return t.chart.scales[a[1]].func(e[r])+t.chart.scales[a[1]].func.rangeBand()/2}).attr("cy",function(e){return t.yScale.func(e.maximum)}).attr("fill",function(t){return ww.Utilities.objectInArray(i,t.FQN,"FQN").Color}).on("mouseover",this.tip.show).on("mouseout",this.tip.hide);var u=o.selectAll(".AVGline").data(function(t){return n.filter(function(e){if(e.state===t)return e})});u.exit().remove(),u.enter().append("line").attr("class","AVGline").attr("x1",function(e){return t.chart.scales[a[1]].func(e[r])+t.chart.scales[a[1]].func.rangeBand()/2-8}).attr("x2",function(e){return t.chart.scales[a[1]].func(e[r])+t.chart.scales[a[1]].func.rangeBand()/2+8}).attr("y1",function(e){return t.yScale.func(e.average)}).attr("y2",function(e){return t.yScale.func(e.average)}).attr("stroke-width",function(){return 1}).attr("stroke",function(){return"black"}),u.attr("x1",function(e){return t.chart.scales[a[1]].func(e[r])+t.chart.scales[a[1]].func.rangeBand()/2-8}).attr("x2",function(e){return t.chart.scales[a[1]].func(e[r])+t.chart.scales[a[1]].func.rangeBand()/2+8}).attr("y1",function(e){return t.yScale.func(e.average)}).attr("y2",function(e){return t.yScale.func(e.average)})}this.stopWatch.logElapsedDuration("lines with dots update took: "),this.stopWatch.reset()},e}(e),n=function(){function t(){}return t.CreateLinesWithDots=function(t){var e=(new ww.Utilities.StopWatch,new i(t));e.update(),t.addElement(e)},t}();t.LinesWithDotsFactory=n}(charts||(charts={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),charts;!function(t){"use strict";var e;!function(t){t[t.PAN_START=0]="PAN_START",t[t.PAN_END=1]="PAN_END",t[t.PAN_MOVE=2]="PAN_MOVE",t[t.PINCH_START=3]="PINCH_START",t[t.PINCH_END=4]="PINCH_END",t[t.PINCH_MOVE=5]="PINCH_MOVE",t[t.MOUSE_ENTER=6]="MOUSE_ENTER",t[t.MOUSE_MOVE=7]="MOUSE_MOVE",t[t.MOUSE_LEAVE=8]="MOUSE_LEAVE",t[t.TOUCH_PRESS=9]="TOUCH_PRESS",t[t.TOUCH_RELEASE=10]="TOUCH_RELEASE"}(e=t.GestureEventType||(t.GestureEventType={}));var i=function(){function t(){}return t}();t.GestureListener=i;var n=function(){function t(){this._eventListeners=new Array,this.options=null}return t.prototype.update=function(){},t.prototype.baseType=function(){return"GenericGesture"},t.prototype.type=function(){return"GenericGesture"},t.prototype.addListener=function(t,e){var i=!0,n={callback:t,type:e};this._eventListeners.forEach(function(t){n.callback===t.callback&&t.type===n.type&&(i=!1)}),i&&this._eventListeners.push(n)},t.prototype.removeListener=function(t,e){var i=-1,n={callback:t,type:e};this._eventListeners.forEach(function(t,e){n.callback===t.callback&&t.type===n.type&&(i=e)}),i>=0&&this._eventListeners.splice(i)},t.prototype.dispatchEvent=function(t,e){this._eventListeners.forEach(function(i){i.type===e&&i.callback(t,i.type)})},t}();t.GenericGesture=n;var s=function(t){function i(e){var i=t.call(this)||this;i.chart=e,i.xScale=null,i.yScale=null,i._el=null,i._pan=null,i._hammer=null,i._pinch=null,i._bounds=null,i._subscription=null,i._hammer=null,i._el=null,i.options=i.chart.options.gesture,i._pan={scaleX:{to:null,from:null},scaleY:{minimum:0,maximum:0}},i._pinch={center:null,pointers:{},direction:0,distancy:0},i._bounds={to:0,from:0,minimum:0,maximum:0},i._subscription={pinch:!1,pan:!1,mouse:!1,touch:!1},i.xScale=i.chart.scales.x0,i.yScale=i.chart.scales.y0;var n=i.xScale.func.domain(),s=i.yScale.func.domain();return i._bounds.to=new Date(n[1]).getTime(),i._bounds.from=new Date(n[0]).getTime(),i._bounds.minimum=s[0],i._bounds.maximum=s[1],i.init_gesture(),i}return __extends(i,t),i.prototype.baseType=function(){return t.prototype.baseType.call(this)},i.prototype.type=function(){return"Gesture"},i.prototype.update=function(){this.subscribe_events(),this._el&&(this._el.style.top=this.chart.margin.top+"px",this._el.style.left=this.chart.margin.left+"px",this._el.style.height=this.chart.height+"px",this._el.style.width=this.chart.width+"px")},i.prototype.on_pan_start=function(t){this.dispatchEvent(t,e.PAN_START)},i.prototype.on_pan_end=function(t){this.dispatchEvent(t,e.PAN_END),null!=this.options.horizontalPan.events&&!0===this.options.horizontalPan.enable&&(this.reset_pan(),this.options.horizontalPan.events.finish(this._pan.scaleX.to,this._pan.scaleX.from))},i.prototype.on_pan_move=function(t){this.options.horizontalPan.events.start(),this.dispatchEvent(t,e.PAN_MOVE)},i.prototype.on_pan_start_basic=function(t,e){this.reset_pan()},i.prototype.on_pan_move_basic=function(t,e){var i=0,n=0,s=Hammer;if((t.direction===s.DIRECTION_LEFT||t.direction===s.DIRECTION_RIGHT)&&this.chart.options.gesture.horizontalPan&&this.chart.options.gesture.horizontalPan.enable){i=parseFloat(((this._pan.scaleX.to-this._pan.scaleX.from)/parseFloat(this._el.style.width)).toFixed(2));var a=new Date(this._pan.scaleX.from-t.deltaX*i).toISOString(),r=new Date(this._pan.scaleX.to-t.deltaX*i).toISOString();this.xScale.setMinMax(a,r)}else if((t.direction===s.DIRECTION_UP||t.direction===s.DIRECTION_DOWN)&&this.chart.options.gesture.verticalPan&&this.chart.options.gesture.verticalPan.enable&&void 0!=typeof this._pan.scaleY.minimum&&void 0!==typeof this._pan.scaleY.maximum&&this._pan.scaleY.minimum!==this._pan.scaleY.maximum){n=parseFloat(((this._pan.scaleY.maximum-this._pan.scaleY.minimum)/parseFloat(this._el.style.height)).toFixed(2));var o=this._pan.scaleY.minimum+t.deltaY*n,c=this._pan.scaleY.maximum+t.deltaY*n;this.yScale.setZoom(o,c)}this.chart.update(!0),t.srcEvent.stopPropagation(),t.preventDefault()},i.prototype.on_pinch_end=function(t){this.dispatchEvent(t,e.PINCH_END),this.options.pinchZoom.events.finish(this._pan.scaleX.to,this._pan.scaleX.from)},i.prototype.on_pinch_move=function(t){this.dispatchEvent(t,e.PINCH_MOVE)},i.prototype.on_pinch_start=function(t){this.dispatchEvent(t,e.PINCH_START)},i.prototype.on_pinch_start_basic=function(t,e){var i=0;for(this.options.pinchZoom.events.start(),this._pinch.center=t.center,this._pinch.direction=0,this._pinch.pointers={},
i=0;i<t.pointers.length;i++)this._pinch.pointers[t.pointers[i].identifier]={},this._pinch.pointers[t.pointers[i].identifier].x=t.pointers[i].clientX,this._pinch.pointers[t.pointers[i].identifier].y=t.pointers[i].clientY;this.reset_pan()},i.prototype.on_pinch_move_basic=function(t,e){var i=0,n=0,s=null,a=null,r=null;this.reset_pan(),this.calculate_pinch_direction(t),s=this._el.getBoundingClientRect(),a=this._pinch.center.x-s.left,i=parseFloat(((this._pan.scaleX.to-this._pan.scaleX.from)/a).toFixed(2)),r=s.width-a,n=parseFloat(((this._pan.scaleX.to-this._pan.scaleX.from)/r).toFixed(2)),a=this._pan.scaleX.from-this._pinch.distancy*n;var o=new Date(a).toISOString();a=this._pan.scaleX.to+this._pinch.distancy*i;var c=new Date(a).toISOString();this.xScale.setMinMax(o,c),this.chart.update(!0),t.srcEvent.stopPropagation(),t.preventDefault()},i.prototype.on_mouse_leave=function(t){this.dispatchEvent(t,e.MOUSE_LEAVE)},i.prototype.on_mouse_move=function(t){this.dispatchEvent(t,e.MOUSE_MOVE)},i.prototype.on_mouse_enter=function(t){this.dispatchEvent(t,e.MOUSE_ENTER)},i.prototype.on_touch_press=function(t){this.dispatchEvent(t,e.TOUCH_PRESS)},i.prototype.on_touch_release=function(t){this.dispatchEvent(t,e.TOUCH_RELEASE)},i.prototype.reset_pan=function(){var t=this.xScale.func.domain(),e=this.yScale.func.domain();this._pan.scaleX.to=new Date(t[1]).getTime(),this._pan.scaleX.from=new Date(t[0]).getTime(),this._pan.scaleY.minimum=e[0],this._pan.scaleY.maximum=e[1]},i.prototype.calculate_pinch_direction=function(t){var e=null,i=null,n=0,s=0,a="";for(a in this._pinch.pointers)e?i||(i={},i.x=this._pinch.pointers[a].x,i.y=this._pinch.pointers[a].y):(e={},e.x=this._pinch.pointers[a].x,e.y=this._pinch.pointers[a].y);n=e.x-i.x,e.y,i.y;for(var r=0;r<t.changedPointers.length;r++)this._pinch.pointers[t.changedPointers[r].identifier].x=t.changedPointers[r].clientX,this._pinch.pointers[t.changedPointers[r].identifier].y=t.changedPointers[r].clientY;i=e=null;for(a in this._pinch.pointers)e?i||(i={},i.x=this._pinch.pointers[a].x,i.y=this._pinch.pointers[a].y):(e={},e.x=this._pinch.pointers[a].x,e.y=this._pinch.pointers[a].y);s=e.x-i.x,e.y,i.y,this._pinch.distancy=n-s},i.prototype.init_gesture=function(){this._hammer=new Hammer(this._el),this._el.style.top=this.chart.margin.top+"px",this._el.style.left=this.chart.margin.left+"px",this._el.style.height=this.chart.height+"px",this._el.style.width=this.chart.width+"px",this.options.panZoomArea&&(this.options.panZoomArea.w=this.chart.width,this.options.panZoomArea.h=this.chart.height);var t=Hammer;this._hammer.get("pan").set({direction:t.DIRECTION_ALL}),this._hammer.get("pinch").set({enable:!0}),this._hammer.get("press").set({enable:!0})},i.prototype.subscribe_events=function(){!this.chart.options.gesture||this._hammer},i}(n);t.Gesture=s;var a=function(){function t(){this.stopWatch=new ww.Utilities.StopWatch}return t.CreateGesture=function(t){t.gesture=new s(t),t.gesture.update(),t.addElement(t.gesture)},t}();t.GesturesFactory=a;var r=function(){function t(){this.restrict="E",this.link={pre:this.pre}}return t.instance=function(){return new t},t.prototype.pre=function(t,e,i){var n=t.canvas;a.CreateGesture(n)},t}();r.$inject=[""],angular.module("ww").directive("wwGesture",r.instance)}(charts||(charts={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),charts;!function(t){"use strict";var e=function(){function t(){}return t.prototype.update=function(){},t.prototype.baseType=function(){return"GenericScooter"},t.prototype.type=function(){return"GenericScooter"},t.prototype.show=function(t,e){},t.prototype.hide=function(){},t}();t.GenericScooter=e;var i=function(e){function i(i,n){var s=e.call(this)||this;s.chart=i,s.options=n,s.chartContainer=null,s._hasInitiated=!1,s._timeoutUpdateValues=null,s.yScale=null,s.xScale=null,s.currentXPos=null,s.scooterData=[],s._lastMoveEvent={ev:null,type:t.GestureEventType.MOUSE_ENTER,fn:null},s.html="<scooter-tooltip style='pointer-events:none;'></scooter-tooltip>",s.SCOOTERLINEANDTOOLTIPDISTANCE=10,s.chart.scooter=s,s.chartContainer=$(s.chart.svg[0]).closest("ww-canvas"),s.scootertooltip=s.chartContainer.find("#scootertooltip"),s.scooterLine=s.chartContainer.find("#scooterLine"),s.interactiveGroup=s.chart.svg.select(".interactive-group"),s.scooterArea=s.interactiveGroup.select(".interactiveArea"),s.scooterArea.empty()&&(s.scooterArea=s.interactiveGroup.append("rect").attr({class:"interactiveArea",x:0,y:0,"fill-opacity":"0"}),s.scooterArea.style("pointer-events","All")),s.scooterGrp=s.chart.g.selectAll(".scooter-group").empty()?s.chart.g.append("g").attr("class","scooter-group").attr("transform","translate(0, 0)"):s.chart.g.selectAll(".scooter-group");var a=window;return a.PointerEvent?(s.scooterArea.on("pointerenter",s.scooterAreaMouseMoveHandler.bind(s)),s.scooterArea.on("pointermove",s.scooterAreaMouseMoveHandler.bind(s)),s.scooterArea.on("pointerleave",s.mouseLeaveEventHandler.bind(s)),d3.select(s.scootertooltip.get(0)).on("pointerenter",s.hide.bind(s)),d3.select(s.scootertooltip.get(0)).on("pointerleave",s.mouseLeaveEventHandler.bind(s)),d3.select(s.scooterLine.get(0)).on("pointerleave",s.mouseLeaveEventHandler.bind(s))):(s.scooterArea.on("mouseenter",s.scooterAreaMouseMoveHandler.bind(s)),s.scooterArea.on("touchstart",s.scooterAreaMouseMoveHandler.bind(s)),s.scooterArea.on("mousemove",s.scooterAreaMouseMoveHandler.bind(s)),s.scooterArea.on("touchmove",s.scooterAreaMouseMoveHandler.bind(s)),s.scooterArea.on("mouseleave",s.mouseLeaveEventHandler.bind(s)),s.scooterArea.on("touchend",s.mouseLeaveEventHandler.bind(s)),d3.select(s.scootertooltip.get(0)).on("mouseleave",s.mouseLeaveEventHandler.bind(s)),d3.select(s.scootertooltip.get(0)).on("touchend",s.mouseLeaveEventHandler.bind(s)),d3.select(s.scootertooltip.get(0)).on("mouseenter",s.hide.bind(s)),d3.select(s.scootertooltip.get(0)).on("touchstart",s.hide.bind(s)),d3.select(s.scooterLine.get(0)).on("mouseleave",s.mouseLeaveEventHandler.bind(s)),d3.select(s.scooterLine.get(0)).on("touchend",s.mouseLeaveEventHandler.bind(s))),s.updateUIElements(0),s.options.behaviour===t.ScooterBehaviours.Solo&&!0===s.options.visible&&setTimeout(function(){var t=null,e=null;a.PointerEvent?(t=document.createEvent("UIEvents"),t.initUIEvent("pointermove",!0,!0)):(t=document.createEvent("UIEvents"),t.initUIEvent("mousemove",!0,!0),e=document.createEvent("UIEvents"),e.initUIEvent("mousemove",!0,!0)),t.pageX=s.scooterArea.attr("width")/2,s.scooterArea.node().dispatchEvent(t),s.show(),null!==e&&(e.pageX=s.scooterArea.attr("width")/2,s.scooterArea.node().dispatchEvent(e),s.show())}),s}return __extends(i,e),i.prototype.baseType=function(){return e.prototype.baseType.call(this)},i.prototype.type=function(){return"Scooter"},i.prototype.show=function(){this.chart.options.scooter.visible&&"hidden"===this.scootertooltip.css("visibility")&&(this.scootertooltip.css("visibility",""),this.scooterLine.css("visibility",""),this.scooterGrp.selectAll("circle").style("visibility",""))},i.prototype.hide=function(){this.scootertooltip.css("visibility","hidden"),this.scooterLine.css("visibility","hidden"),this.scooterGrp.selectAll("circle").style("visibility","hidden")},i.prototype.update=function(){var e=this;if(!this.chart.options.scooter.visible)return void this.hide();this.show(),this._lastMoveEvent.fn&&this._lastMoveEvent.ev&&this._lastMoveEvent.fn(this._lastMoveEvent.ev,this._lastMoveEvent.type);var i=this.chart.g;this.yScale=this.chart.scales[this.chart.options.scooter.yaxisScale+0],this.xScale=this.chart.scales[this.chart.options.scooter.xaxisScale+0],this.yAxisMargin=d3.transform(i.attr("transform")).translate[0],this.scooterArea.attr({width:this.chart.width,height:this.chart.height}),this.scooterData=[];var n=[];this.chart.data.forEach(function(t,i){n.indexOf(t.FQN)<0&&(n.push(t.FQN),!0===t.visible&&e.scooterData.push({fqn:t.FQN,EngUnit:t.EngUnit,color:t.Color,value:"",visibility:""}))}),"hidden"!==this.scootertooltip.css("visibility")&&this.scooterAreaMouseMoveHandler(void 0,t.GestureEventType.MOUSE_MOVE)},i.prototype.updateUIElements=function(t){this.scooterLine.css("margin-top",this.chart.margin.top),this.scooterLine.css("height",this.chart.height),this.scootertooltip.css("margin-top",this.chart.margin.top);var e=t+this.SCOOTERLINEANDTOOLTIPDISTANCE;e=e+this.scootertooltip.width()>this.chart.width?t-this.scootertooltip.width()-this.SCOOTERLINEANDTOOLTIPDISTANCE:t+this.SCOOTERLINEANDTOOLTIPDISTANCE,this.scootertooltip.css("left",e+(this.yAxisMargin-1)+"px"),this.scooterLine.css("left",t+this.yAxisMargin-1+"px"),this.scooterLine.css("height",this.chart.height)},i.prototype.updateScooterData=function(t,e){var i=this;this.xScale&&this.xScale.func&&(null!==this._timeoutUpdateValues&&(clearTimeout(this._timeoutUpdateValues),this._timeoutUpdateValues=null),this._timeoutUpdateValues=setTimeout(function(){$(i.scooterData).each(function(t,e){e.value="",e.position=void 0}),$(i.chart.children).each(function(e,n){angular.isDefined(n.updateScooterValues)&&n.updateScooterValues(i.scooterData,t)}),i.updateUIElements(t);var e=new Date(i.xScale.func.invert(t));i.scootertooltip.find(".scooterDateTime").text(e.toLocaleString("en-US",{hour12:!1})),i.updateTooltipValue(i.scooterData),i.updateHighlightPoint(i.scooterData),0===i.scooterData.length?i.hide():i.show()},0))},i.prototype.createTooltipDataStructure=function(t){for(var e=t.filter(function(t){return"none"!==t.visibility}),i=[],n=e.length,s=n>5?n%2==0?n/2:(n+1)/2:n,a=n>5?2:1,r=0;r<s;r++){var o={values:[]};o.values.push(e[r*a]),n>5&&r*a+1<n&&o.values.push(e[r*a+1]),i.push(o)}return i},i.prototype.updateTooltipValue=function(t){var e=this.createTooltipDataStructure(t),i=d3.select(this.scootertooltip.get(0)).select("#scooterTooltipValueContainer").selectAll("div").data(e,function(t){return Math.random().toString()});i.enter().append("div").attr("class","scooterRow"),i.exit().remove(),i.selectAll("div").remove();var n=i.selectAll("div").data(function(t){return t.values});n.enter().append("div").attr("class","scooterCell"),n.append("div").attr("class","scooterColorBar").style("background-color",function(t){d3.select(this.parentNode).style("display",t.visibility);return t.color}),n.append("div").attr("class","scooterTagValue").text(function(t){return t.value})},i.prototype.updateHighlightPoint=function(t){var e={stroke:function(t){return t.color},r:"2.5",fill:function(t){return t.color},opacity:".87",display:function(t){return angular.isDefined(t.visibility)?t.visibility:""},visibility:function(t){return angular.isDefined(t.position)?"visible":"hidden"},cx:function(t){return angular.isDefined(t.position)?t.position.x:null},cy:function(t){return angular.isDefined(t.position)?t.position.y:null}},i=this.scooterGrp.selectAll("circle").data(t,function(t){return t.fqn}).attr(e);i.enter().append("circle").attr(e).on("mouseleave",this.mouseLeaveEventHandler),i.exit().remove()},i.prototype.mouseLeaveEventHandler=function(e,i){if(angular.isDefined(this.chart)&&!1!==this.chart.options.scooter.visible)if("touchend"===d3.event.type)this.hide();else{var n=d3.event,s=n.pageX-$(this.scooterArea[0]).offset().left,a=n.pageY-$(this.scooterArea[0]).offset().top,r=$(n.target),o=this.chartContainer.find(r).length||this.scootertooltip.find(r).length;this.options.behaviour!==t.ScooterBehaviours.Solo&&(i===t.GestureEventType.TOUCH_RELEASE||!o||s<1||s>this.chart.width-1||a<1||a>this.chart.height-1)&&this.hide()}},i.prototype.scooterAreaMouseMoveHandler=function(e,i){if(angular.isDefined(this.chart)&&!1!==this.chart.options.scooter.visible){var n=0;if(i==t.GestureEventType.PAN_MOVE){e.pageX=e.pointers[0].pageX,n=e.pageX-$(this.scooterArea).offset().left;d3.transform(this.chart.g.attr("transform")).translate[0];this._lastMoveEvent.ev=e,this._lastMoveEvent.type=i,n<0?n=0:n>this.chart.width&&(n=this.chart.width)}else{var s=d3.event;if(null===s){var a;e?a=e.pageX:this._lastMoveEvent.ev&&(a=this._lastMoveEvent.ev.pageX),n=this.currentXPos,null===n&&(n=this.chart.width/2)}else{if(this.options.behaviour!==t.ScooterBehaviours.Solo&&"mouse"===s.pointerType&&1===s.buttons)return void this.hide();this._lastMoveEvent.ev=s;var a=s.pageX;"touchstart"!==d3.event.type&&"touchmove"!==d3.event.type||(a=s.touches[0].pageX),n=a-$(this.scooterArea[0]).offset().left,n<0?n=0:n>this.chart.width&&(n=this.chart.width),this.currentXPos=n}}this.updateScooterData(n,a)}},i}(e);t.Scooter=i;var n=function(){function t(){this.stopWatch=new ww.Utilities.StopWatch}return t.CreateScooter=function(t,e){var n=new i(t,e);n.update(),t.addElement(n)},t}();t.ScooterFactory=n;var s=function(){function t(t){this.$compile=t,this.restrict="E",this.link={pre:this.pre},this.template="<scooter-tooltip style= 'pointer-events:none;' > </scooter-tooltip>"}return t.factory=function(){var e=function(e){return new t(e)};return e.$inject=["$compile"],e},t.prototype.pre=function(t,e,i){var s=t.canvas;n.CreateScooter(s,t.chart.options.scooter)},t}();s.$inject=["$compile"],angular.module("ww").directive("wwScooter",s.factory());var a=function(){function t(){this.restrict="E",this.templateUrl="./partials/scooter.html"}return t.instance=function(){return new t},t}();a.$inject=[""],angular.module("ww").directive("scooterTooltip",a.instance)}(charts||(charts={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),charts;!function(t){"use strict";var e=function(){function t(){}return t.prototype.update=function(){},t.prototype.baseType=function(){return"GenericToolbar"},t.prototype.type=function(){return"GenericToolbar"},t}();t.GenericToolbar=e;var i=function(t){function e(e,i,n){var s=t.call(this)||this;s.chart=e,s.$scope=i,s.$compile=n,s.toolbarHtml='<md-toolbar class="toolbar">                            \n                        </md-toolbar>',s.toolbarElement=null,s.buttons_count=0;var a=s.chart.options.toolbar;if(null!==a&&a.visible){var r=angular.element(s.toolbarHtml);$(s.chart.element[0]).append(r),s.$compile(r),s.toolbarElement=$(s.chart.element[0]).find(".toolbar"),s.toolbarElement.css({position:"absolute",top:"0",height:a.height,"min-height":a.height,"max-height":a.height}),s.toolbarElement.css(a.style),s.chart.margin.top+=a.height,s.chart.update(!0)}return s}return __extends(e,t),e.prototype.baseType=function(){return t.prototype.baseType.call(this)},e.prototype.type=function(){return"Toolbar"},e.prototype.createButtons=function(){var t=this;if(null!==this.toolbarElement){this.chart.options.toolbar;if(this.toolbarElement){if(this.toolbarElement&&this.toolbarElement.length>0)for(;this.toolbarElement[0].firstChild;)this.toolbarElement[0].removeChild(this.toolbarElement[0].firstChild);this.$scope.chart=this.chart,this.$scope._onButtonClick=this._onButtonClick;var e=angular.element('<md-fab-actions class="md-toolbar-tools actions" style="height:30px">\n            <md-button aria-label="comment" class="md-icon-button" ng-repeat="bnt in chart.options.toolbar.buttons" ng-click="_onButtonClick()" >\n            <md-tooltip ng-if="bnt.toolTip.length > 0">\n                {{bnt.toolTip}}\n            </md-tooltip>\n            <md-icon md-svg-src={{bnt.image}} style="color:{{bnt.color}}"></md-icon>\n        </md-button></md-fab-actions>');this.toolbarElement.append(e);this.$compile(e)(this.$scope),setTimeout(function(){t.$scope.$digest()},10)}}},e.prototype._onButtonClick=function(){this.bnt.events.click(this.bnt)},e.prototype.update=function(){null!==this.toolbarElement&&(!0===this.chart.options.toolbar.visible?(this.chart.options.toolbar.buttons.length!==this.buttons_count&&(this.buttons_count=this.chart.options.toolbar.buttons.length,this.createButtons()),this.toolbarElement&&this.toolbarElement.css("display","flex")):this.toolbarElement&&this.toolbarElement.css("display","none"))},e}(e);t.Toolbar=i;var n=function(){function t(){this.stopWatch=new ww.Utilities.StopWatch}return t.CreateToolbar=function(t,e,n){var s=new i(t,e,n);s.createButtons(),s.update(),t.addElement(s)},t}();t.ToolbarFactory=n;var s=function(){function t(t){var e=this;this.$compile=t,this.restrict="E",this.link={pre:function(t,i,s){var a=t.canvas;n.CreateToolbar(a,t,e.$compile)}}}return t.factory=function(){var e=function(e){return new t(e)};return e.$inject=["$compile"],e},t}();angular.module("ww").directive("wwToolbar",s.factory())}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function t(t){var e=this;this.chart=t,this.menuCurtain=null,this.menu=null,this.closeContextMenu=function(){e.menuCurtain.style("display","none"),e.menu.style("display","none")},this.menuCurtain=this.chart.element.select("#chart-menu-curtain"),this.menu=this.chart.element.select("#chart-menu"),this.initialize()}return t.prototype.initialize=function(){var t=($(this.menuCurtain[0]),$(this.menu[0]),$(this.chart.element[0])),e=this.chart.margin;this.chart.element.selectAll(".yaxis-interactive-area").on("click",function(){var i=d3.mouse(this);d3.select(this.parentElement).select("#chart-menu-curtain").style("display","block");var n=$(this),s=t.height(),a=t.width(),r=$("#chart-menu").height(),o=$("#chart-menu").width(),c=i[1];n.is("#verticalInteractiveArea")&&(c+=e.top-10,c=r+c>s?c-(c+r-10-s):c);var h=i[0];n.is("#horizantalInteractiveArea")&&(h=o+i[0]+e.left>a?i[0]-(o+i[0]+e.left-a):i[0]+e.left,h=h),d3.select(t[0]).select("#chart-menu").style("display","flex").style("left",h+"px").style("top",c+"px")}),this.menuCurtain.on("click",this.closeContextMenu),this.menu.on("click",this.closeContextMenu)},t}(),i=function(){function t(t){this.$compile=t,this.restrict="A",this.link={pre:this.pre},this.templateUrl="./partials/yAxisInteraction.html",this.scope=!0}return t.factory=function(){var e=function(e){return new t(e)};return e.$inject=["$compile"],e},t.prototype.pre=function(t,i,n){var s=t.canvas;new e(s)},t}();i.$inject=["$compile"],angular.module("ww").directive("enableInteraction",i.factory())}(charts||(charts={}));var charts;!function(t){var e=function(){function t(t,e){this.$http=t,this.$timeout=e,this.token="eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6Im1pZ3VlbC50bjJAb3V0bG9vay5jb20iLCJ0ZW5hbnRpZCI6IjI2ODJiNDA3LWYyMzUtNGQzZC05ZTA2LTI0MjMwOGQ3NGVjNyIsImdpdmVuX25hbWUiOiJNaWd1ZWwiLCJmYW1pbHlfbmFtZSI6IlROMiIsInRlbmFudG5hbWUiOiJUZW5hbnQgVHdvIiwiaXNzIjoiaHR0cHM6Ly93b25kZXJ3YXJlLmF1dGgwLmNvbS8iLCJhdWQiOiJxTmFCVGhVcXFEZ0pISGk2c2VKd1ZpeDM2MktCQnYwMCIsImV4cCI6MTQ5MzQwMTY0NywibmJmIjoxNDkxNTg3MjQ3fQ.WjdiniESoCY40sxBTdsYUjXtrO0ndh22vgWcvn2fZ1w"}return t.prototype.retrieveData=function(t,e,i){return this.$timeout(function(){i.resolve()},18e4),this.$http({method:"POST",url:t,data:e,headers:{Authorization:"Bearer "+this.token},timeout:i.promise}).success(function(t,e,n,s){return i.resolve(t)}).error(function(t,e,n,s){return"function"==typeof i.reject?i.reject({response:t,status:e,headers:n,config:s}):null})},t}();e.$inject=["$http","$timeout"],t.Resource=e,angular.module("ww").service("wwResource",e)}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function t(t,e,i,n){this.$scope=t,this.$element=e,this.$attrs=i,this.$compile=n,this.chartContainer=null,this.data=null,this.options=null,this.chartId="chart_"+Date.now().toString(),this.canvases=[],this.element=null,this.createChart()}return t.prototype.createChart=function(){this.element=this.$element[0],this.chartContainer=this.$element.parent()[0],this.data=this.$scope.$parent[this.$attrs.data],this.options=this.$scope.$parent[this.$attrs.options],this.$scope.chart=this;var t=this;this.$scope.$parent.redrawChart=function(){t.redrawChart()}},t.prototype.redrawChart=function(){this.data=this.$scope.$parent[this.$attrs.data],this.options=this.$scope.$parent[this.$attrs.options],this.canvases.forEach(function(t){t.update(!0)})},t}();e.$inject=["$scope","$element","$attrs","$compile"];var i=function(){function t(t){this.$compile=t,this.restrict="E",this.scope={name:"="},this.bindToController=!0,this.controller=e,this.template="<ww-canvas>\n                        <ww-grid ng-show='canvas.options.grid.visible === true'></ww-grid>\n                        <ww-axes enable-interaction></ww-axes>\n                        <ww-lines></ww-lines>\n                        <ww-limit-lines></ww-limit-lines>\n                        <ww-scooter></ww-scooter>\n                        <ww-pan-and-zoom></ww-pan-and-zoom>\n                        <ww-toolbar></ww-toolbar>\n                    </ww-canvas>"}return t.factory=function(){var e=function(e){return new t(e)};return e.$inject=["$compile"],e},t}();angular.module("ww").directive("lineChart",i.factory())}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function e(t,e,i){this.$scope=t,this.$element=e,this.$attrs=i,this.baseChart=null,this.chartContainer=null,this.data=null,this.options=null,this.chartId="chart_"+Date.now().toString(),this.canvases=[],this.element=null,this.createChart()}return e.prototype.createChart=function(){this.element=this.$element[0];var e=this.$scope.$parent;this.chartContainer=this.$element.parent()[0],this.data=e.data,this.options=e.options;var i=new t.Canvas(this);this.canvases.push(this.baseChart),new t.AxesFactory(i),t.GridsFactory.CreateGrids(i),t.BarsFactory.CreateBars(i,t.Orientation.Vertical),t.LimitLinesFactory.CreateLimitLines(i);var n=this;e.redrawChart=function(){n.redrawChart()}},e.prototype.redrawChart=function(){this.data=this.$scope.$parent[this.$attrs.data],this.options=this.$scope.$parent[this.$attrs.options],this.canvases.forEach(function(t){t.update(!0)})},e}();e.$inject=["$scope","$element","$attrs"];var i=function(){function t(){this.restrict="E",this.scope={name:"="},this.bindToController=!0,this.controller=e}return t}();angular.module("ww").directive("columnChart",[function(){return new i}])}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function e(t,e,i){this.$scope=t,this.$element=e,this.$attrs=i,this.baseChart=null,this.chartContainer=null,this.data=null,this.options=null,this.chartId="chart_"+Date.now().toString(),this.canvases=[],this.element=null,this.createChart()}return e.prototype.createChart=function(){this.element=this.$element[0];var e=this.$scope.$parent;this.chartContainer=this.$element.parent()[0],this.data=e.data,this.options=e.options,this.baseChart=new t.Canvas(this),this.canvases.push(this.baseChart),new t.AxesFactory(this.baseChart),t.GridsFactory.CreateGrids(this.baseChart),t.BarsFactory.CreateBars(this.baseChart,t.Orientation.Vertical),t.LimitLinesFactory.CreateLimitLines(this.baseChart);var i=this;e.redrawChart=function(){i.redrawChart()}},e.prototype.redrawChart=function(){this.data=this.$scope.$parent[this.$attrs.data],this.options=this.$scope.$parent[this.$attrs.options],this.canvases.forEach(function(t){t.update(!0)})},e}();e.$inject=["$scope","$element","$attrs"];var i=function(){function t(){this.restrict="E",this.scope={name:"="},this.bindToController=!0,this.controller=e}return t}();angular.module("ww").directive("cumulativeSumChart",[function(){return new i}])}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function e(t,e,i){this.$scope=t,this.$element=e,this.$attrs=i,this.chart=null,this.chartContainer=null,this.data=null,this.options=null,this.chartId="chart_"+Date.now().toString(),this.canvases=[],this.element=null,this.createChart()}return e.prototype.createChart=function(){this.element=this.$element[0],this.chartContainer=this.$element.parent()[0],this.data=this.$scope.$parent[this.$attrs.data],this.options=this.$scope.$parent[this.$attrs.options],this.chart=new t.Canvas(this),this.canvases.push(this.chart),new t.AxesFactory(this.chart),t.BarsFactory.CreateBars(this.chart,t.Orientation.Horizontal);var e=this;this.$scope.$parent.redrawChart=function(){e.redrawChart()}},e.prototype.redrawChart=function(){this.data=this.$scope.$parent[this.$attrs.data],this.options=this.$scope.$parent[this.$attrs.options],this.canvases.forEach(function(t){t.update(!0)})},e}();e.$inject=["$scope","$element","$attrs"];var i=function(){function t(){this.restrict="E",this.scope={name:"="},this.controller=e,this.bindToController=!0}return t}();angular.module("ww").directive("summarybarsChart",[function(){return new i}])}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function e(t,e,i){this.$scope=t,this.$element=e,this.$attrs=i,this.baseChart=null,this.chartContainer=null,this.data=null,this.options=null,this.chartId="chart_"+Date.now().toString(),this.canvases=[],this.element=null,this.createChart()}return e.prototype.createChart=function(){this.element=this.$element[0],this.chartContainer=this.$element.parent()[0],this.data=this.$scope.$parent[this.$attrs.data],this.options=this.$scope.$parent[this.$attrs.options],this.baseChart=new t.Canvas(this),this.canvases.push(this.baseChart),new t.AxesFactory(this.baseChart),t.CirclesFactory.CreateCircles(this.baseChart),new t.LinesFactory(this.baseChart);var e=this;this.$scope.$parent.redrawChart=function(){e.redrawChart()}},e.prototype.redrawChart=function(){this.data=this.$scope.$parent[this.$attrs.data],this.options=this.$scope.$parent[this.$attrs.options],this.canvases.forEach(function(t){t.update(!0)})},e}();e.$inject=["$scope","$element","$attrs"];var i=function(){function t(){this.restrict="E",this.scope={name:"="},this.bindToController=!0,this.controller=e}return t}();angular.module("ww").directive("xyPlot",[function(){return new i}])}(charts||(charts={}));var charts;!function(t){"use strict";var e=function(){function e(t,e,i){this.$scope=t,this.$element=e,this.$attrs=i,this.baseChart=null,this.chartContainer=null,this.data=null,this.options=null,this.chartId="chart_"+Date.now().toString(),this.canvases=[],this.element=null,this.createChart()}return e.prototype.createChart=function(){this.element=this.$element[0],this.chartContainer=this.$element.parent()[0],this.data=this.$scope.$parent[this.$attrs.data],this.options=this.$scope.$parent[this.$attrs.options],this.baseChart=new t.Canvas(this),this.canvases.push(this.baseChart),new t.AxesFactory(this.baseChart),t.GridsFactory.CreateGrids(this.baseChart),t.BarsFactory.CreateBars(this.baseChart,t.Orientation.Vertical),t.LinesWithDotsFactory.CreateLinesWithDots(this.baseChart),t.LimitLinesFactory.CreateLimitLines(this.baseChart);var e=this;this.$scope.$parent.redrawChart=function(){e.redrawChart()}},e.prototype.redrawChart=function(){this.data=this.$scope.$parent[this.$attrs.data],this.options=this.$scope.$parent[this.$attrs.options],this.canvases.forEach(function(t){t.update(!0)})},e}();e.$inject=["$scope","$element","$attrs"];var i=function(){function t(){this.restrict="E",this.scope={name:"="},this.bindToController=!0,this.controller=e}return t}();angular.module("ww").directive("timeInStateChart",[function(){return new i}])}(charts||(charts={}));