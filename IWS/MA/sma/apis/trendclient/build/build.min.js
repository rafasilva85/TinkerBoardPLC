!function(){function t(e,i,o){function n(a,l){if(!i[a]){if(!e[a]){var r="function"==typeof require&&require;if(!l&&r)return r(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[a]={exports:{}};e[a][0].call(h.exports,function(t){var i=e[a][1][t];return n(i||t)},h,h.exports,t,e,i,o)}return i[a].exports}for(var s="function"==typeof require&&require,a=0;a<o.length;a++)n(o[a]);return n}return t}()({1:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.Axes=i.MAX=i.MIN=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=t("./Zoom"),a=t("./misc/Helper"),l=t("./misc/ToolbarButton"),r=i.MIN=0,u=i.MAX=1;i.Axes=function(){function t(e){var i=this;o(this,t),this._ee=new EventEmitter,this._globals=e,this._helper=a.Helper.get(),this._duration=0,this._yMin=0,this._yMax=0,this._showVerticalGrid=!1,this._showHorizontalGrid=!1,this._globals.zoom.on("zoom-in",function(t){i.onZoomIn(t)}),this._globals.zoom.on("zoom-out",function(t){i.onZoomOut(t)}),this._globals.zoom.on("cancel-zoom",function(t){i.onCancelZoom(t)}),this._globals.zoom.on("auto-scale",function(t){i.onAutoScale(t)}),this._panAndZoom=this._globals.scope.options.d3PanAndZoom,this._panAndZoom.pan.onEndHandler=this.onGestureFinish.bind(this),this._panAndZoom.zoom.onEndHandler=this.onGestureFinish.bind(this),this._panAndZoom.zoom.onStartHandler=function(){i._globals.processingGesture=!0},this._panAndZoom.pan.onStartHandler=function(){i._globals.processingGesture=!0},this.x.minMax[0]=Date.now()-1e3*this._duration,this.x.minMax[1]=Date.now()}return n(t,[{key:"onZoomIn",value:function(t){var e=this.y.minMax[u]-this.y.minMax[r];e/=2,this.y.minMax[u]=e+e/2+this.y.minMax[r],this.y.minMax[r]=e-e/2+this.y.minMax[r],this.calculateX(),this._ee.emitEvent("duration-change",[{data:this._duration,origin:"server"}]),this._globals.redraw()}},{key:"onZoomOut",value:function(t){var e=this.y.minMax[u]-this.y.minMax[r];e/=2,this.y.minMax[u]=e+2*e+this.y.minMax[r],this.y.minMax[r]=e-2*e+this.y.minMax[r],this.calculateX(),this._ee.emitEvent("duration-change",[{data:this._duration,origin:"server"}]),this._globals.redraw()}},{key:"onCancelZoom",value:function(t){this._globals.zoom.xOrigin!==this._duration&&(this._parseDuration(this._duration,!1),this._globals.zoom.xOrigin=this._duration),this.y.minMax.length=0,this.y.minMax.push(this._yMin),this.y.minMax.push(this._yMax),this.calculateX(),this._globals.redraw(),this._ee.emitEvent("duration-change",[{data:this._duration,origin:"server"}]),this._globals.redraw()}},{key:"onAutoScale",value:function(t){this._globals.initialized!==!1&&this._globals.autoScale.calculated!==!1&&(this.y.minMax[r]=this._globals.autoScale.min,this.y.minMax[u]=this._globals.autoScale.max,this._yMin=this._globals.autoScale.min,this._yMax=this._globals.autoScale.max,this._globals.redraw())}},{key:"onGestureFinish",value:function(t,e){var i=0,o=0;(this._globals.onlineOnly!==!1||this._globals.waittingQueryResult!==!0)&&(o=parseInt(Math.abs(e-t)/1e3),o!=this._duration&&this._parseDuration(o,!0),this.x.minMax.length=0,this._globals.zoom.ranges.length=0,this._globals.zoom.state=0,this._globals.zoom.type=s.EZoomType.NO_ZOOM,this._globals.running===!1?(this.x.minMax.push(t),this.x.minMax.push(e)):(i=Date.now(),this.x.minMax.push(i-1e3*this._duration),this.x.minMax.push(i)),this._ee.emitEvent("duration-change",[{data:this._duration,origin:"server"}]),this._globals.processingGesture=!1)}},{key:"periodType",value:function(t){}},{key:"duration",value:function e(t){var i=0,o=null,e=0;if(0!==t.value.length){if(t.value.indexOf(":")<-1&&t.value.indexOf(".")>t.value.indexOf(":")&&(t.value=t.value.split(".")[0]),t.value.indexOf(".")>-1||-1===t.value.indexOf(":")){if(i=parseFloat(t.value),NaN===i)return;e=3600*i}else t.value.indexOf(":")>=2&&(o=t.value.split(":"),e=0,o.length>=1&&(e+=3600*parseInt(o[0])),o.length>=2&&(e+=60*parseInt(o[1])),o.length>=3&&(e+=parseInt(o[2])));e!==this._duration&&(this._duration=e,this.x.minMax[r]=this.x.minMax[u]-1e3*this._duration,this._globals.zoom.reset(),this._globals.zoom.xOrigin=this._duration,this._helper.parseDates(this._globals.scope),this._globals.redraw(),this._ee.emitEvent("duration-change",[{data:this._duration,origin:"server"}]))}}},{key:"calculateX",value:function(){var t=this.x.minMax[r],e=this.x.minMax[u],i=this._globals.zoom,o=0,n=0,a=0,l=null,h=Math.abs(i.state);if(i.type===s.EZoomType.NO_ZOOM||0===i.state?a=1e3*this._duration:i.state>0?a=this._duration/Math.pow(2,h)*1e3:i.state<0&&(a=this._duration*Math.pow(2,h)*1e3),1e3*i.xOrigin!==a&&(i.xOrigin=a/1e3,this._parseDuration(i.xOrigin,!1)),l=h>1&&i.ranges.length>0?i.ranges[h-2]:{to:e,from:t},this._globals.running===!0)o=Date.now(),n=o-a;else if(l&&h>0){if(i.state>0){if(o=l.to-a/2,n=l.from+a/2,1e3>o-n)return}else i.state<0&&(o=l.to+a/2,n=l.from-a/2);i.ranges.push({to:o,from:n})}else n=t,o=e;n!==o&&(this.x.minMax.length=0,this.x.minMax.push(n),this.x.minMax.push(o)),i.avoidZeroState=!1}},{key:"_parseDuration",value:function(t,e){var i=0,o=0,n=0,s=[];i=parseInt(t/3600),o=parseInt(t%3600/60),n=parseInt(t%3600%60),e===!0&&(this._duration=t),s.push(this._helper.numToTimePart(i)),s.push(this._helper.numToTimePart(o)),s.push(this._helper.numToTimePart(n)),this._ee.emitEvent("duration-change",[{data:s.join(":"),origin:"local"}]),this._globals.zoom.avoidZeroState=!0}},{key:"enableMultiSections",value:function(t){var e=this._globals.scope.options,i=this._globals.hasMultiScales?"MULTI":"SINGLE",o=null;e.axes[0].type=t?"STACKED":i,o=this._helper.retrieveButton(this._globals.scope,l.EToolbarButtonType.MULTI_SECTIONS),o&&(o.state=t?1:0),this._globals.redraw()}},{key:"multiSections",value:function(t){this.enableMultiSections(0!==parseInt(t.value))}},{key:"time",value:function(t){}},{key:"yMin",value:function(t){this._yMin=parseFloat(t.value),this.y.minMax.length=0,this.y.minMax.push(this._yMin),this.y.minMax.push(this._yMax),this._globals.axes.yMin=this._yMin,this._globals.redraw()}},{key:"yMax",value:function(t){this._yMax=parseFloat(t.value),this.y.minMax.length=0,this.y.minMax.push(this._yMin),this.y.minMax.push(this._yMax),this._globals.axes.yMax=this._yMax,this._globals.redraw()}},{key:"on",value:function(t,e){this._ee.on(t,e)}},{key:"_showGridMode",value:function(t){var e=this._globals.scope.options.grid;this._showVerticalGrid&&this._showHorizontalGrid?(e.mode=0,e.visible=!0,e.style={stroke:t.value},e.showHorizontalLines=!0):this._showVerticalGrid?(e.mode=0,e.visible=!0,e.style={stroke:t.value},e.showHorizontalLines=!1):this._showHorizontalGrid?(e.mode=1,e.visible=!1,e.showHorizontalLines=!0,e.style={stroke:t.value}):(e.showHorizontalLines=!1,e.visible=!1),this._globals.redraw()}},{key:"xAxesGridColor",value:function(t){""!=t.value&&(this._showVerticalGrid=!0),this._showGridMode(t)}},{key:"yAxesGridColor",value:function(t){""!=t.value&&(this._showHorizontalGrid=!0),this._showGridMode(t)}},{key:"xAxesDivision",value:function(t){if(""!=t.value){var e=this._globals.scope.options;e.axes[1].ticks=t.value}}},{key:"yAxesDivision",value:function(t){if(""!=t.value){var e=this._globals.scope.options;e.axes[0].ticks=t.value,e.grid.horizontalLines=new Array(parseFloat(t.value))}}},{key:"scooterColor",value:function(t){if(""!=t.value){var e=this._globals.scope.options.scooter;e.color=t.value}}},{key:"yAxisMultipleScales",value:function(t){if(""!=t.value){var e=this._globals.scope.options.multipleScales;e.visible="1"==t.value}}},{key:"y",get:function(){return this._globals.scope.options.axes[0]},set:function(t){this._globals.scope.options.axes[0]=t}},{key:"x",get:function(){return this._globals.scope.options.axes[1]},set:function(t){this._globals.scope.options.axes[1]=t}}]),t}()},{"./Zoom":5,"./misc/Helper":8,"./misc/ToolbarButton":11}],2:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();i.Legend=function(){function t(e){o(this,t),this._globals=e,this._legend=this._globals.scope.options.legend}return n(t,[{key:"visible",value:function(t){this._legend.visible=0!==parseInt(t.value)?!0:!1,this._globals.redraw()}}]),t}()},{}],3:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.Pens=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=t("./misc/Helper");i.Pens=function(){function t(e){var i=this;o(this,t),this._helper=s.Helper.get(),this._globals=e,this._idToPen={},this._pens=this._globals.scope.data,this._globals.hasMultiScales=!1,this._globals.zoom.on("auto-scale",function(t){i.onAutoScale(t)})}return n(t,[{key:"label",value:function(t){var e=t.propName.substr(-4,4),i=this._idToPen[e];i.FQN=e+"."+t.value,i.TagName=this.value,this._globals.redraw()}},{key:"color",value:function(t){var e=t.propName.substr(-4,4),i=this._idToPen[e];i.Color=this._helper.numToRGB(t.value),this._globals.redraw()}},{key:"tagField",value:function(t){var e=t.propName.substr(-4,4),i=this._idToPen[e];if(this._globals.running!==!1&&(0!=this._globals.onlineOnly||this._globals.waittingQueryResult!==!0)&&!isNaN(parseFloat(t.value)))if(0===i.values.length||i.values[i.values.length-1].FakeValue===!1){var o={DateTime:new Date(Date.now()).toISOString(),Value:parseFloat(t.value),OpcQuality:192,FakeValue:!1,FQN:i.FQN};i.values.push(o)}else{var n=i.values[i.values.length-1];n.DateTime=new Date(Date.now()).toISOString(),n.Value=parseFloat(t.value),n.FakeValue=!1}}},{key:"hide",value:function(t){var e=t.propName.substr(-4,4),i=this._idToPen[e];""!=t.value?i.visible=0===parseInt(t.value)?!0:!1:i.visible=!0,this._calculateMultipleScalesForVisiblePen(this._pens),this._globals.redraw()}},{key:"minScale",value:function(t){var e=t.propName.substr(-4,4),i=this._idToPen[e];return i._setScales.min=!0,t&&isNaN(t.value)!==!0?(0===t.value.length?i.EngUnitMin=0:i.EngUnitMin=parseFloat(t.value),this._checkMultiScales(i),this._yAxesMultipleScalesWidth(this._pens),void this._globals.redraw()):(i.EngUnitMin=0,void this._checkMultiScales(i))}},{key:"maxScale",value:function(t){var e=t.propName.substr(-4,4),i=this._idToPen[e];return i._setScales.max=!0,t&&isNaN(t.value)!==!0?(0===t.value.length?i.EngUnitMax=0:i.EngUnitMax=parseFloat(t.value),this._checkMultiScales(i),this._yAxesMultipleScalesWidth(this._pens),void this._globals.redraw()):(i.EngUnitMax=0,void this._checkMultiScales(i))}},{key:"removeUnused",value:function(t,e){var i=[];this._pens.forEach(function(o){for(o.values.forEach(function(n){var s=new Date(n.DateTime).getTime();(t>=s+6e4||s>e)&&i.push(o)});i.length>0;)o.values.splice(i.pop(),1)})}},{key:"removeArchestrAUnused",value:function(t,e){var i=[];this._pens.forEach(function(o){if(o.values>2)for(o.values.forEach(function(n){var s=new Date(n.DateTime).getTime();(t>=s+6e4||s>e)&&i.push(o)});i.length>0;)o.values.splice(i.pop(),1)})}},{key:"clearValues",value:function(t){if(t)for(var e=0;e<t.length;e++)this._idToPen["000"+t[e].index].values.length=0;else for(var i in this._idToPen)this._idToPen[i].values.length=0}},{key:"addPen",value:function(t,e){e._setScales={min:!1,max:!1},this._idToPen[t]=e,this._pens.unshift(this._idToPen[t])}},{key:"addPoint",value:function(t,e){var i=null;i=this._idToPen[this._helper.numToKey(t)],i&&(e.FQN=i.FQN,e.TagName=i.FQN,i.values.push(e))}},{key:"addFakePoints",value:function(t){this._pens.forEach(function(e){if(e.values.length>0){var i=e.values[e.values.length-1];if(i.FakeValue===!0)i.DateTime=t;else{var o=JSON.parse(JSON.stringify(i));o.DateTime=t,o.FakeValue=!0,e.values.push(o)}}else{var n={DateTime:t,Value:"",OpcQuality:192,FakeValue:!0,FQN:e.FQN};e.values.push(n)}})}},{key:"onAutoScale",value:function(t){var e=this,i=!1,o=this._globals.scope.options;return this._pens.forEach(function(t){t.visible===!0&&(i=!0)}),i===!1?void(this._globals.autoScale.calculated=!1):(this._globals.autoScale.min=Number.MAX_SAFE_INTEGER,this._globals.autoScale.max=Number.MIN_SAFE_INTEGER,this._pens.forEach(function(t){t.visible!==!1&&(t.EngUnitMin=Number.MAX_SAFE_INTEGER,t.EngUnitMax=Number.MIN_SAFE_INTEGER,e._globals.hasMultiScales=!0,"SINGLE"===o.axes[0].type&&(o.axes[0].type="MULTI"),t.values.forEach(function(i){e._globals.autoScale.min=Math.min(e._globals.autoScale.min,i.Value),e._globals.autoScale.max=Math.max(e._globals.autoScale.max,i.Value),t.EngUnitMin=Math.min(t.EngUnitMin,i.Value),t.EngUnitMax=Math.max(t.EngUnitMax,i.Value)}))}),void(this._globals.autoScale.calculated=!0))}},{key:"_checkMultiScales",value:function(t){this._globals.hasMultiScales!==!0&&(this._globals.hasMultiScales=t._setScales.min===!0||t._setScales.max===!0)}},{key:"_yAxesMultipleScalesWidth",value:function(t){t.forEach(function(t){t.OriEngUnitMin=t.EngUnitMin,t.OriEngUnitMax=t.EngUnitMax,""===t.EngUnitMin&&(t.EngUnitMin=0),""===t.EngUnitMax&&(t.EngUnitMax=100),t.EngUnitMin>=t.EngUnitMax&&(t.EngUnitMin=0,t.EngUnitMax=100)}),this._calculateMultipleScalesForVisiblePen(t)}},{key:"_calculateMultipleScalesForVisiblePen",value:function(t){if(t.length>0){var e=t.filter(function(t){return t.visible}),i=0;e.length>0&&(i=Math.max(this._yTickWidth(Math.round(e[0].EngUnitMax).toLocaleString()),this._yTickWidth(Math.round(e[0].EngUnitMin).toLocaleString()))),this._globals.scope.options.multipleScales.width=i+10,this._globals.scope.options.multipleScales.visiblePens=e,this._globals.scope.$apply()}}},{key:"_yTickWidth",value:function(t){for(var e=0,i=0;i<t.length;i++)e+="-"==t.charAt(i)?5:","==t.charAt(i)||"."==t.charAt(i)?3:7;return e}}]),t}()},{"./misc/Helper":8}],4:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.Toolbar=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=t("./misc/ToolbarButton"),a=t("./misc/Helper");i.Toolbar=function(){function t(e){o(this,t),this._ee=new EventEmitter,this._globals=e,this._toolbar=this._globals.scope.options.toolbar,this._scooter=this._globals.scope.options.scooter,this._gesture=this._globals.scope.options.gesture,this._helper=a.Helper.get()}return n(t,[{key:"visible",value:function(t){isNaN(t.value)!==!0&&(this._toolbar.visible=0!==parseInt(t.value)?!0:!1,this._globals.redraw())}},{key:"runStopVisible",value:function(t){var e=null;e=this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.RUN_STOP),1!==parseInt(t.value)||e||(e=new s.ToolbarButton,e.id=s.EToolbarButtonType.RUN_STOP,this._globals.running===!0?e.image="./img/icons/pause.svg":e.image="./img/icons/play.svg",e.state=this._globals.running===!1?0:1,e.events.click=this.runStop.bind(this),this._toolbar.buttons.push(e),this._globals.redraw())}},{key:"periodVisible",value:function(t){}},{key:"cursorVisible",value:function(t){var e=null;e=this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.CURSOR),1!==parseInt(t.value)||e||(e=new s.ToolbarButton,e.id=s.EToolbarButtonType.CURSOR,this._globals.cursorVisible===!0?e.image="./img/icons/cursor_enabled.svg":e.image="./img/icons/cursor_desabled.svg",e.state=this._scooter.visible===!1?0:1,e.events.click=this.cursor.bind(this),this._toolbar.buttons.push(e),this._globals.redraw())}},{key:"zoomInVisible",value:function(t){var e=null;e=this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.ZOOM_IN),1!==parseInt(t.value)||e||(e=new s.ToolbarButton,e.id=s.EToolbarButtonType.ZOOM_IN,e.image="./img/icons/zoom_in.svg",e.events.click=this.zoomIn.bind(this),this._toolbar.buttons.push(e),this._globals.redraw())}},{key:"zoomOutVisible",value:function(t){var e=null;e=this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.ZOOM_OUT),1!==parseInt(t.value)||e||(e=new s.ToolbarButton,e.id=s.EToolbarButtonType.ZOOM_OUT,e.image="./img/icons/zoom_out.svg",e.events.click=this.zoomOut.bind(this),this._toolbar.buttons.push(e),this._globals.redraw())}},{key:"cancelZoomVisible",value:function(t){var e=null;e=this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.CANCEL_ZOOM),1!==parseInt(t.value)||e||(e=new s.ToolbarButton,e.id=s.EToolbarButtonType.CANCEL_ZOOM,e.image="./img/icons/cancel_zoom.svg",e.events.click=this.cancelZoom.bind(this),this._toolbar.buttons.push(e),this._globals.redraw())}},{key:"autoScaleVisible",value:function(t){var e=null;e=this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.AUTO_SCALE),1!==parseInt(t.value)||e||(e=new s.ToolbarButton,e.id=s.EToolbarButtonType.AUTO_SCALE,e.image="./img/icons/auto_scale.svg",e.events.click=this.autoScale.bind(this),this._toolbar.buttons.push(e),this._globals.redraw())}},{key:"multiSectionsVisible",value:function(t){var e=null;e=this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.MULTI_SECTIONS),1!==parseInt(t.value)||e||(e=new s.ToolbarButton,e.id=s.EToolbarButtonType.MULTI_SECTIONS,e.image="./img/icons/multi_sections.svg",e.events.click=this.multiSections.bind(this),this._toolbar.buttons.push(e),this._globals.redraw())}},{key:"runStopTooltip",value:function(t){var e=null;e=this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.RUN_STOP),1!==parseInt(t.value)||e||(e.toolTip=t.value)}},{key:"periodTooltip",value:function(t){}},{key:"cursorTooltip",value:function(t){var e=null;e=this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.CURSOR),1!==parseInt(t.value)||e||(e.toolTip=t.value)}},{key:"zoomInTooltip",value:function(t){var e=null;e=this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.ZOOM_IN),1!==parseInt(t.value)||e||(e.toolTip=t.value)}},{key:"zoomOutTooltip",value:function(t){var e=null;e=this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.ZOOM_OUT),1!==parseInt(t.value)||e||(e.toolTip=t.value)}},{key:"cancelZoomTooltip",value:function(t){var e=null;e=this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.CANCEL_ZOOM),1!==parseInt(t.value)||e||(e.toolTip=t.value)}},{key:"autoScaleTooltip",value:function(t){var e=null;e=this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.AUTO_SCALE),1!==parseInt(t.value)||e||(e.toolTip=t.value)}},{key:"multiSectionsTooltip",value:function(t){var e=null;e=this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.MULTI_SECTIONS),1!==parseInt(t.value)||e||(e.toolTip=t.value)}},{key:"runStop",value:function(t){var e=this,i=t&&t.events?"toolbar":"server",o=null;return(o="toolbar"===i?t:this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.RUN_STOP))?("server"===i?o.state=parseInt(t.value):o.state=0===o.state?1:0,0===o.state?o.image="./img/icons/play.svg":o.image="./img/icons/pause.svg",this._globals.running=1===o.state,this._gesture.horizontalPan.enable=!this._scooter.visible&&!this._globals.running,"server"===i&&setTimeout(function(){return e._globals.scope.$digest()},0),this._ee.emitEvent("run-stop-change",[{data:o.state,origin:i}]),void this._globals.redraw()):(this._globals.running=1===parseInt(t.value),void(this._gesture.horizontalPan.enable=!this._scooter.visible&&!this._globals.running))}},{key:"cursor",value:function(t){var e=this,i=t&&t.events?"toolbar":"server",o=null;return(o="toolbar"===i?t:this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.CURSOR))?("server"===i?o.state=parseInt(t.value):o.state=0===o.state?1:0,0===o.state?o.image="./img/icons/cursor_desabled.svg":o.image="./img/icons/cursor_enabled.svg",this._scooter.visible=1===o.state,"server"===i&&setTimeout(function(){return e._globals.scope.$digest()},0),this._gesture.horizontalPan.enable=!this._scooter.visible&&!this._globals.running,this._ee.emitEvent("cursor-change",[{data:o.state,origin:i}]),void this._globals.redraw()):(this._scooter.visible=0===parseInt(t.value)?!1:!0,this._gesture.horizontalPan.enable=!this._scooter.visible&&!this._globals.running,void(this._scooterInterval||(this._scooterInterval=setInterval(function(){charts&&null!=this._globals.scope.$$childTail&&null!=this._globals.scope.$$childTail.canvas&&$("#scootertooltip").length>0&&$("#scooterLine").length>0&&(clearInterval(this._scooterInterval),this._scooterInterval=null,charts.ScooterFactory.CreateScooter(this._globals.scope.$$childTail.canvas,this._scooter))}.bind(this),50))))}},{key:"zoomIn",value:function(t){var e=t&&t.events?"toolbar":"server";this._globals.initialized!==!1&&this._globals.zoom.dispatchZoomIn({data:t,origin:e})}},{key:"zoomOut",value:function(t){var e=t&&t.events?"toolbar":"server";this._globals.initialized!==!1&&this._globals.zoom.dispatchZoomOut({data:t,origin:e})}},{key:"cancelZoom",value:function(t){var e=t&&t.events?"toolbar":"server";this._globals.initialized!==!1&&this._globals.zoom.dispatchCancelZoom({data:t,origin:e})}},{key:"autoScale",value:function(t){var e=this,i=t&&t.events?"toolbar":"server",o=null;this._globals.initialized!==!1&&(o="toolbar"===i?t:this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.AUTO_SCALE),"server"===i?(setTimeout(function(){return e._globals.scope.$digest()},0),null!==o&&(o.state=parseInt(t.value))):null!==o&&(o.state=0===o.state?1:0),this._globals.zoom.dispatchAutoScale({data:t,origin:i}))}},{key:"multiSections",value:function(t){var e=this,i=t&&t.events?"toolbar":"server",o=null;this._globals.initialized!==!1&&(o="toolbar"===i?t:this._helper.retrieveButton(this._globals.scope,s.EToolbarButtonType.MULTI_SECTIONS),"server"===i?(setTimeout(function(){return e._globals.scope.$digest()},0),null!==o&&(o.state=parseInt(t.value))):null!==o&&(o.state=0===o.state?1:0),this._ee.emitEvent("multi-sections-change",[{data:o.state,origin:i}]))}},{key:"on",value:function(t,e){this._ee.on(t,e)}}]),t}()},{"./misc/Helper":8,"./misc/ToolbarButton":11}],5:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=(i.Zoom=function(){function t(){o(this,t),this.globals=null,this._ee=new EventEmitter,this.reset()}return n(t,[{key:"reset",value:function(){this.state=0,this.ranges=[],this.avoidZeroState=!1,this.type=s.NO_ZOOM,this.xOrigin=0}},{key:"dispatchZoomIn",value:function(t){if(this.globals.initialized!==!1){if(this.globals.enableZoomIn===!1)return void(this.globals.enableZoomIn=!0);for(this.state++;Math.abs(this.state)<this.ranges.length;)this.ranges.pop();this.type=s.ZOOM_IN,this.avoidZeroState=!0,this._ee.emitEvent("zoom-in",[t])}}},{key:"dispatchZoomOut",value:function(t){if(this.globals.initialized!==!1){if(this.globals.enableZoomOut===!1)return void(this.globals.enableZoomOut=!0);for(this.state--;Math.abs(this.state)<this.ranges.length;)this.ranges.pop();this.type=s.ZOOM_OUT,this.avoidZeroState=!0,this._ee.emitEvent("zoom-out",[t])}}},{key:"dispatchCancelZoom",value:function(t){return this.globals.enableCancelZoom===!1?void(this.globals.enableCancelZoom=!0):(this.ranges.length=0,this.state=0,this.type=s.NO_ZOOM,this.avoidZeroState=!1,void this._ee.emitEvent("cancel-zoom",[t]))}},{key:"dispatchAutoScale",value:function(t){this._ee.emitEvent("auto-scale",[t])}},{key:"on",value:function(t,e){this._ee.on(t,e)}}]),t}(),i.EZoomType=function(){function t(){o(this,t)}return n(t,null,[{key:"NO_ZOOM",get:function(){return 0}},{key:"ZOOM_IN",get:function(){return 1}},{key:"ZOOM_OUT",get:function(){return 2}},{key:"ZOOM_CANCEL",get:function(){return 2}}]),t}())},{}],6:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();i.Data=function(){function t(e){o(this,t),this._globals=e,this._initScope()}return n(t,[{key:"_initScope",value:function(){this._globals.scope.data=[],this._globals.scope.options={circles:null,linesWithDots:null,gesture:{horizontalPan:{enable:!0,events:{finish:null,start:null}},verticalPan:{enable:!1},pinchZoom:{enable:!0,events:{finish:null,start:null}},panZoomArea:{w:0,h:0}},toolbar:{visible:!0,height:30,style:{},buttons:[]},title:"",margin:{top:8,left:60,bottom:60,right:30},multipleScales:{visible:!1,width:35,marginTop:10,marginBottom:10,visiblePens:[]},legend:{visible:!0,placement:"bottom",showUnits:!1},axes:[{name:"y",title:"",dataType:3,dates:null,orientation:0,hideLine:!1,ticks:-1,basedOn:"Value",useDataAlone:!0,includeFields:["EngUnitMin","EngUnitMax"],includeValues:[],visible:!0,range:null,index:[],bands:!1,groupBy:"",timeAggregate:null,type:"SINGLE",labelsAngles:0,ticksLength:10,justScale:!1,minMax:[0,100],enableInteractiveArea:!1},{name:"x",title:"",dataType:1,dates:{toStr:(new Date).toISOString(),fromStr:(new Date).toISOString()},orientation:1,hideLine:!1,ticks:3,basedOn:"DateTime",useDataAlone:!1,includeFields:["EngUnitMin","EngUnitMax"],includeValues:[],visible:!0,range:null,index:[],bands:!1,groupBy:"",timeAggregate:null,type:"SINGLE",labelsAngles:0,ticksLength:10,justScale:!1,minMax:[0,0],dateTimeMultiline:!0,enableInteractiveArea:!1}],limitLines:[{xaxisScale:"x",yaxisScale:"y",text:"Max allowed limit",visible:!1,position:50}],grid:{style:{stroke:"#ddd"},visible:!1,mode:2,horizontalAxis:"x0",verticalAxis:"y0",horizontalLines:[],showHorizontalLines:!1},scooter:{visible:!0,xaxisScale:"x",yaxisScale:"y",behaviour:1,color:""},lines:{style:{fill:"none","stroke-opacity":1,"stroke-width":1.5},highlightLastPoint:!1,fillArea:!1,visible:!0,index:-1,xaxisScale:"x",yaxisScale:"y"},hBars:{minimum:0,maximum:0,text:"minimum",xaxisScale:"x",yaxisScale:"y"},vBars:{xaxisScale:"",yaxisScale:"",groupBy:"",drillIn:"",visible:!1,basedOn:"",hideSubgroupLines:!1,tooltip:!1},d3PanAndZoom:{pan:{enable:!0},zoom:{enable:!0},xAxisScale:"x",yAxisScale:"y"},allowedTimeRange:[Number.MIN_VALUE,Number.MAX_VALUE],animationType:1,dateTimeFormat:"%x , %X",disablePanAndZoomControlsArea:!0}}}]),t}()},{}],7:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();i.Globals=function(){function t(e,i,n,s,a,l){o(this,t),this.scope=e,this.interval=i,this.timeout=n,this.compile=s,this.running=a,this.cursoVisible=!1,this.waittingQueryResult=!1,this.zoom=l,this.chartArea=null,this.initialized=!1,this.processingGesture=!1,this.zoom.globals=this,this.onlineOnly=!1,this.hasMultiScales=!1,this.enableZoomIn=!0,this.enableZoomOut=!0,this.enableCancelZoom=!0,this._redrawPending=!1,this._trendUpdateRate=1e3,this.axes={yMin:0,yMax:100},this.autoScale={min:0,max:0,calculated:!1};try{var r=document.cookie.replace(/(?:(?:^|.*;\s*)_x_config\s*\=\s*([^;]*).*$)|^.*$/,"$1"),u=null;r&&(u=JSON.parse(unescape(r)),this._trendUpdateRate=u.trendUpdateRate)}catch(h){this._trendUpdateRate=1e3}setInterval(this.redraw.bind(this),this._trendUpdateRate,!0)}return n(t,[{key:"redraw",value:function(t){if(!t)return void(this._redrawPending=!0);if(this._redrawPending!==!1){try{this.scope.redrawChart&&this.scope.redrawChart()}catch(e){}this._redrawPending=!1,this.chartArea=this.scope.options.gesture.panZoomArea}}},{key:"loaderTrigger",value:function(){var t=null;t=$(".loader"),null!==t&&("none"!==t.css("display")?t.css("display","none"):t.css("display","block"))}},{key:"loaderShow",value:function(){var t=null;t=$(".loader"),null!==t&&t.css("display","block")}},{key:"loaderHide",value:function(){var t=null;t=$(".loader"),null!==t&&t.css("display","none")}},{key:"chartVisibility",value:function(t){var e=null;e=$(".chart-container"),null!==e&&e.css("visibility",t)}}]),t}()},{}],8:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();i.Helper=function(t){function e(){return o(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return s(e,t),a(e,[{key:"parseDates",value:function(t){t.options.axes.forEach(function(t){if(null!==t.dates){var e=t.dates.toStr,i=t.dates.fromStr;t.dates.to||(t.dates=new charts.Dates),t.dates.set(i,e)}})}},{key:"retrieveButton",value:function(t,e){var i=null;return t.options.toolbar.buttons.forEach(function(t){return t.id===e?void(i=t):void 0}),i}}],[{key:"get",value:function(){return this.helper||(this.helper=new e),this.helper}}]),e}(window.SmaCustomWidget.Helper)},{}],9:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();i.Module=function(){function t(e){o(this,t),this.sma_trend=angular.module("sma_trend",["ww","ngMaterial"]).config(["$mdThemingProvider",this.startModule]),this.sma_trend.controller("SmaTrendController",["$scope","$interval","$timeout","$compile",e.init.bind(e)]),angular.bootstrap(document.body,["sma_trend"])}return n(t,[{key:"startModule",value:function(t){t.definePalette("mcgpalette0",{50:"#ffffff",100:"#ffffff",200:"#ffffff",300:"#ffffff",400:"#ffffff",500:"#f3f3f5",600:"#e2e2e7",700:"#d2d2d9",800:"#c1c1cb",900:"#b0b0bd",A100:"#ffffff",A200:"#ffffff",A400:"#ffffff",A700:"#d2d2d9",contrastDefaultColor:"light",contrastDarkColors:"50 100 200 300 400 500 600 700 800 900 A100 A200 A400 A700"}),t.definePalette("mcgpalette1",{50:"#e8eaf6",100:"#c5cae9",200:"#9fa8da",300:"#7986cb",400:"#5c6bc0",500:"#3f51b5",600:"#3949ab",700:"#303f9f",800:"#283593",900:"#1a237e",A100:"#8c9eff",A200:"#536dfe",A400:"#3d5afe",A700:"#304ffe",contrastDefaultColor:"light",contrastDarkColors:"50 100 200 A100"
}),t.theme("default").primaryPalette("mcgpalette0").accentPalette("mcgpalette1")}}]),t}()},{}],10:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();i.ProxyManager=function(){function t(e){o(this,t),this._proxy=window.SmaCustomWidget.proxy,this.trend=e,this._hasReceivedCount=!1,this._interval=null,this.trend.axes.on("duration-change",this.onAxesDurationChange.bind(this)),this.trend.toolbar.on("run-stop-change",this.onToolbarRunStopChange.bind(this)),this.trend.toolbar.on("multi-sections-change",this.onToolbarMultiSectionsChange.bind(this)),this._proxy.autoResize=!1,this._proxy.addOnLoad(this._onLoad.bind(this)),this._proxy.addOnShow(this._onShow.bind(this)),this._proxy.addOnHide(this._onHide.bind(this)),this._host=this._proxy.host,this._proxy.registerTouchEvents&&this._proxy.registerTouchEvents(),this.EnumRuntimeScadaEngine={InduSoft:0,ArchestrA:1,ClearSCADA:2},this._proxy.ready=!0}return n(t,[{key:"setTrendQuery",value:function(t,e,i){this._host&&this._host.win&&this._host.win.services&&this._host.win.services.setTrendQuery(this._host.screenId,this._proxy.propertiesInfo.QueryResults.id,t,e,i)}},{key:"_onLoad",value:function(){this._proxy.on("PointsCount",this._proxyTreatPointsCount,this),this._proxy.on("ToolbarVisible",this.trend.toolbar.visible,this.trend.toolbar),this._proxy.on("ToolbarRunStopVisible",this.trend.toolbar.runStopVisible,this.trend.toolbar),this._proxy.on("ToolbarPeriodVisible",this.trend.toolbar.periodVisible,this.trend.toolbar),this._proxy.on("ToolbarCursorVisible",this.trend.toolbar.cursorVisible,this.trend.toolbar),this._proxy.on("ToolbarZoomInVisible",this.trend.toolbar.zoomInVisible,this.trend.toolbar),this._proxy.on("ToolbarZoomOutVisible",this.trend.toolbar.zoomOutVisible,this.trend.toolbar),this._proxy.on("ToolbarCancelZoomVisible",this.trend.toolbar.cancelZoomVisible,this.trend.toolbar),this._proxy.on("ToolbarAutoScaleVisible",this.trend.toolbar.autoScaleVisible,this.trend.toolbar),this._proxy.on("ToolbarMultiSectionsVisible",this.trend.toolbar.multiSectionsVisible,this.trend.toolbar),this._proxy.on("ToolbarRunStopTooltip",this.trend.toolbar.runStopTooltip,this.trend.toolbar),this._proxy.on("ToolbarPeriodTooltip",this.trend.toolbar.periodTooltip,this.trend.toolbar),this._proxy.on("ToolbarCursorTooltip",this.trend.toolbar.cursorTooltip,this.trend.toolbar),this._proxy.on("ToolbarZoomInTooltip",this.trend.toolbar.zoomInTooltip,this.trend.toolbar),this._proxy.on("ToolbarZoomOutTooltip",this.trend.toolbar.zoomOutTooltip,this.trend.toolbar),this._proxy.on("ToolbarCancelZoomTooltip",this.trend.toolbar.cancelZoomTooltip,this.trend.toolbar),this._proxy.on("ToolbarAutoScaleTooltip",this.trend.toolbar.autoScaleTooltip,this.trend.toolbar),this._proxy.on("ToolbarMultiSectionsTooltip",this.trend.toolbar.multiSectionsTooltip,this.trend.toolbar),this._proxy.on("ToolbarRunStop",this.trend.toolbar.runStop,this.trend.toolbar),this._proxy.on("ToolbarCursor",this.trend.toolbar.cursor,this.trend.toolbar),this._proxy.on("ToolbarZoomIn",this.trend.toolbar.zoomIn,this.trend.toolbar),this._proxy.on("ToolbarZoomOut",this.trend.toolbar.zoomOut,this.trend.toolbar),this._proxy.on("ToolbarCancelZoom",this.trend.toolbar.cancelZoom,this.trend.toolbar),this._proxy.on("ToolbarAutoScale",this.trend.toolbar.autoScale,this.trend.toolbar),this._proxy.on("ToolbarMultiSections",this.trend.toolbar.multiSections,this.trend.toolbar),this._proxy.on("LegendVisible",this.trend.legend.visible,this.trend.legend),this._proxy.on("PeriodType",this.trend.axes.periodType,this.trend.axes),this._proxy.on("AxesDuration",this.trend.axes.duration,this.trend.axes),this._proxy.on("AxesTime",this.trend.axes.time,this.trend.axes),this._proxy.on("AxesYMin",this.trend.axes.yMin,this.trend.axes),this._proxy.on("AxesYMax",this.trend.axes.yMax,this.trend.axes),this._proxy.on("AxesMultiSections",this.trend.axes.multiSections,this.trend.axes),this._proxy.on("AxesColor",this.trend.axes.xAxesGridColor,this.trend.axes),this._proxy.on("YAxisGridColor",this.trend.axes.yAxesGridColor,this.trend.axes),this._proxy.on("AxesGridDivision",this.trend.axes.xAxesDivision,this.trend.axes),this._proxy.on("YAxisGridDivision",this.trend.axes.yAxesDivision,this.trend.axes),this._proxy.on("AxesCursorCursorColor",this.trend.axes.scooterColor,this.trend.axes),this._proxy.on("EnableYAxisMultipleScales",this.trend.axes.yAxisMultipleScales,this.trend.axes),this._proxy.on("AdvancedUpdateTrigger",this.trend.updateTrigger,this.trend),this._proxy.on("QueryResults",this.trend.queryResults,this.trend),this._proxy.on("TrendControlDataPointsCollection",this.trend.updatePointCollection,this.trend)}},{key:"_proxyTreatPointsCount",value:function(t){var e=0,i="",o="";if(this._hasReceivedCount!==!0){this._hasReceivedCount=!0,e=parseInt(t.value);for(var n=0;e>n;n++)i=""+n,o="0000",o=o.substring(0,o.length-i.length)+i,this.trend.pens.addPen(o,{FQN:"",Source:"",TagName:"",Color:"",EngUnit:"",EngUnitMax:"",EngUnitMin:"",InterpolationType:"Linear",IsSelected:"true",values:[],receivedOn:0,visible:!0}),this._proxy.on("PointLabel"+o,this.trend.pens.label,this.trend.pens),this._proxy.on("PointColor"+o,this.trend.pens.color,this.trend.pens),this._proxy.on("PointTagField"+o,this.trend.pens.tagField,this.trend.pens),this._proxy.on("PointHide"+o,this.trend.pens.hide,this.trend.pens),this._proxy.on("PointMinScale"+o,this.trend.pens.minScale,this.trend.pens),this._proxy.on("PointMaxScale"+o,this.trend.pens.maxScale,this.trend.pens)}}},{key:"_onShow",value:function(){this._proxy.host.widget.params&&this._proxy.host.widget.params._attr.engine===this.EnumRuntimeScadaEngine.ArchestrA?(this._interval=setInterval(this.trend.updateTrigger.bind(this.trend),1e3),this._proxy.host.widget.domNode.contentDocument.body&&this._proxy.host.widget.domNode.contentDocument.body.classList.add("ma_disable_native_touch")):this.trend.onShow()}},{key:"_onHide",value:function(){if(this._proxy.host.widget.params&&this._proxy.host.widget.params._attr.engine===this.EnumRuntimeScadaEngine.ArchestrA){if(this._interval&&(clearInterval(this._interval),this._interval=null,this.trend&&this.trend.pens&&this.trend.pens._pens&&this.trend.pens._pens.length>0)){for(var t=this.trend.pens._pens,e=0;e<t.length;e++)t[e]&&(t[e].values=[]);this.trend._globals.redraw()}this._proxy.host.widget.domNode.contentDocument.body&&this._proxy.host.widget.domNode.contentDocument.body.classList.remove("ma_disable_native_touch")}else this.trend.onHide()}},{key:"onAxesDurationChange",value:function(t){"local"===t.origin&&this._proxy.set({propName:"AxesDuration",value:t.data})}},{key:"onToolbarRunStopChange",value:function(t){"server"!==t.origin&&this._proxy.set({propName:"ToolbarRunStop",value:t.data})}},{key:"onToolbarMultiSectionsChange",value:function(t){"server"!==t.origin&&this._proxy.set({propName:"ToolbarMultiSections",value:t.data})}}]),t}()},{}],11:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();i.ToolbarButton=function s(){o(this,s),this.id=-1,this.image=0,this.color="#000000",this.toolTip="",this.events={click:null},this.state=0},i.EToolbarButtonType=function(){function t(){o(this,t)}return n(t,null,[{key:"RUN_STOP",get:function(){return 0}},{key:"CURSOR",get:function(){return 1}},{key:"ZOOM_IN",get:function(){return 2}},{key:"ZOOM_OUT",get:function(){return 3}},{key:"CANCEL_ZOOM",get:function(){return 4}},{key:"AUTO_SCALE",get:function(){return 5}},{key:"MULTI_SECTIONS",get:function(){return 6}}]),t}()},{}],12:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.Trend=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=t("./misc/ProxyManager"),a=t("./misc/Data"),l=t("./misc/Module"),r=t("./misc/Globals"),u=t("./misc/Helper"),h=t("./misc/ToolbarButton"),c=t("./Toolbar"),p=t("./Legend"),d=t("./Axes"),b=t("./Pens"),_=t("./Zoom"),g=i.Trend=function(){function t(){o(this,t),this._module=new l.Module(this),this._helper=u.Helper.get()}return n(t,[{key:"init",value:function(t,e,i,o){var n=this;this._globals=new r.Globals(t,e,i,o,!1,new _.Zoom),this._data=new a.Data(this._globals),this.toolbar=new c.Toolbar(this._globals),this.legend=new p.Legend(this._globals),this.pens=new b.Pens(this._globals),this.axes=new d.Axes(this._globals),this._chart=null,this._timeOutStartQuery=null,this._isHidden=!1,this.axes.on("duration-change",function(t){"server"===t.origin&&n._startQuery()}),this.axes.on("run-stop-change",function(t){n._globals.running===!0&&(n.axes.calculateX(),n._startQuery())}),this.toolbar.on("multi-sections-change",function(t){isNaN(t.data)!==!0&&(n.axes.enableMultiSections(0!==parseInt(t.data)),n._globals.redraw())}),this._proxyManager=new s.ProxyManager(this)}},{key:"onShow",value:function(){this._globals.enableZoomIn=!1,this._globals.enableZoomOut=!1,this._globals.enableCancelZoom=!1,this.axes.calculateX(),this._startQuery()}},{key:"onHide",value:function(){this._isHidden=!0,this._globals.chartVisibility("hidden")}},{key:"updatePointCollection",value:function(t){var e=t.value.split("|").filter(function(t){return t}),i=this.pens._idToPen[t.name.split("_")[1]];i.values=[];for(var o=0;o<e.length;o++){var n=e[o];if(""!=n&&n.indexOf(":")>-1){var s=n.split(":"),a=(s[0],{DateTime:new Date(parseFloat(s[1])).toISOString(),Value:parseFloat(s[0]),OpcQuality:192,FakeValue:!1,FQN:i.FQN});i.values.push(a)}}}},{key:"updateTrigger",value:function(t){var e=null,i=null;e=this._helper.retrieveButton(this._globals.scope,h.EToolbarButtonType.RUN_STOP),e&&0===e.state||(this.axes.calculateX(),i=new Date(this.axes.x.minMax[d.MAX]).toISOString(),this.pens.addFakePoints(i),this._globals.processingGesture!==!1||1!=this._globals.onlineOnly&&this._globals.waittingQueryResult!==!1||(this._globals.redraw(),this._updateMultiScales()),this._proxyManager._host.widget.params&&this._proxyManager._host.widget.params._attr.engine===this._proxyManager.EnumRuntimeScadaEngine.ArchestrA?this.pens.removeArchestrAUnused(this.axes.x.minMax[d.MIN],this.axes.x.minMax[d.MAX]):this.pens.removeUnused(this.axes.x.minMax[d.MIN],this.axes.x.minMax[d.MAX]))}},{key:"queryResults",value:function(t){var e=this;if(this._globals.initialized===!1){this._helper.parseDates(this._globals.scope),this._globals.loaderTrigger(),this._chart=angular.element('<line-chart data="data" options="options" class="chart-object"></line-chart>'),this._chart.appendTo(".chart-container"),this._globals.compile(this._chart)(this._globals.scope);var i=$(".loader");if(i.css("background-color","transparent"),i.css("border-style","none"),this._globals.initialized=!0,!t.value.unusable)return void this._startQuery();this._globals.onlineOnly=!0,this._globals.loaderHide()}if(t.value&&t.value.rows&&this._globals.onlineOnly!==!0){this.pens.clearValues(t.value.indexes);var o=null;t.value.rows.forEach(function(i){i.forEach(function(i,n){if(0===n){if(!i.value||0===i.value.length)return;o=1e3*(parseInt(i.value)+t.value.startTicks),o=new Date(o).toISOString()}else{var s=n-1;t.value.indexes&&t.value.indexes[n-1].index&&(s=t.value.indexes[n-1].index),e.pens.addPoint(s,{DateTime:o,Value:parseFloat(i.value),OpcQuality:192,FakeValue:!1})}})}),this._globals.waittingQueryResult=!1,this._globals.loaderHide(),this._globals.redraw(),1!=this._globals.scope.options.grid.visible&&setTimeout(function(){e._globals.scope.options.grid.visible=!0,e._globals.redraw()},500),this._isHidden&&setTimeout(function(){e._globals.chartVisibility("visible")},1e3)}}},{key:"_startQuery",value:function(){return this._globals.initialized!==!1?(this._globals.waittingQueryResult=!0,null===this._globals.chartArea?(null!==this._timeOutStartQuery&&(clearTimeout(this._timeOutStartQuery),this._timeOutStartQuery=null),void(this._timeOutStartQuery=setTimeout(this._startQuery.bind(this),10))):void this._proxyManager.setTrendQuery(parseInt((this.axes.x.minMax[d.MIN]/1e3).toFixed()),parseInt((this.axes.x.minMax[d.MAX]/1e3).toFixed()),this._globals.chartArea.w)):void 0}},{key:"_updateMultiScales",value:function(){if(null!=this._globals.scope.$$childTail&&null!=this._globals.scope.$$childTail.canvas){this._globals.scope.options.multipleScales.visiblePens=this.pens._pens.filter(function(t){return t.visible});var t=this._globals.scope.options.multipleScales.visiblePens,e=this._globals.scope.$$childTail.canvas.height,i=parseInt(e/2/13.2);i<t.length&&(this._globals.scope.options.multipleScales.visiblePens=t.slice(t.length-i)),this._globals.scope.$apply()}}}]),t}();new g},{"./Axes":1,"./Legend":2,"./Pens":3,"./Toolbar":4,"./Zoom":5,"./misc/Data":6,"./misc/Globals":7,"./misc/Helper":8,"./misc/Module":9,"./misc/ProxyManager":10,"./misc/ToolbarButton":11}]},{},[12]);
//# sourceMappingURL=Z:/.helpers/tasks/../../dailybuilds/trendclient/trendclient/build/build.min.js.map